<div class="lm-Widget" id="main" data-direction="top-to-bottom" data-alignment="start" style="min-width: 0px; min-height: 0px;"><div class="lm-Widget lm-Panel lm-SplitPanel" data-orientation="horizontal" data-alignment="start" id="main-split-panel" style="position: absolute; contain: strict; min-width: 0px; min-height: 0px; top: 0px; left: 0px; width: 696px; height: 621px;"><div class="lm-Widget lm-Panel lm-mod-hidden lm-SplitPanel-child" id="jp-left-stack" role="complementary" style="position: absolute; contain: strict;"><button class="jp-Button jp-SidePanel-collapse lm-Widget" title="Collapse left side panel"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" data-icon="ui-components:close" data-icon-id="22880390-0b5b-4107-b303-5e38e5a5c45a"><g class="jp-icon-none jp-icon-selectable-inverse jp-icon3-hover" fill="none"><circle cx="12" cy="12" r="11"></circle></g><g class="jp-icon3 jp-icon-selectable jp-icon-accent2-hover" fill="#616161"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></g><g class="jp-icon-none jp-icon-busy" fill="none"><circle cx="12" cy="12" r="7"></circle></g></svg></button><div class="lm-Widget lm-Panel lm-StackedPanel" style="min-width: 0px; min-height: 0px;"><div class="lm-Widget jp-SidePanel jp-TableOfContents lm-mod-hidden lm-StackedPanel-child" id="table-of-contents" role="region" aria-label="Table of Contents section" style="position: absolute; contain: strict; --neutral-layer-card-container: #333333; --neutral-layer-floating: #4a4a4a; --neutral-layer-1: #3b3b3b; --neutral-layer-2: #333333; --neutral-layer-3: #2b2b2b; --neutral-layer-4: #242424; --fill-color: #3b3b3b; --accent-fill-rest: #3195e4; --accent-fill-hover: #36a0f4; --accent-fill-active: #2b87cf; --accent-fill-focus: #3195e4; --accent-foreground-rest: #4eabf5; --accent-foreground-hover: #6ab9f7; --accent-foreground-active: #3aa2f4; --accent-foreground-focus: #4eabf5; --neutral-fill-rest: #4c4c4c; --neutral-fill-hover: #545454; --neutral-fill-active: #474747; --neutral-fill-focus: #3b3b3b; --neutral-fill-input-rest: #3b3b3b; --neutral-fill-input-hover: #3b3b3b; --neutral-fill-input-active: #3b3b3b; --neutral-fill-input-focus: #3b3b3b; --neutral-fill-stealth-rest: #3b3b3b; --neutral-fill-stealth-hover: #474747; --neutral-fill-stealth-active: #424242; --neutral-fill-stealth-focus: #3b3b3b; --neutral-fill-strong-rest: #a7a7a7; --neutral-fill-strong-hover: #bbbbbb; --neutral-fill-strong-active: #9a9a9a; --neutral-fill-strong-focus: #a7a7a7; --neutral-fill-layer-rest: #424242; --focus-stroke-outer: #929292; --focus-stroke-inner: #0d3e65; --neutral-foreground-hint: #a7a7a7; --neutral-foreground-rest: #ffffff; --neutral-stroke-rest: #7a7a7a; --neutral-stroke-hover: #a1a1a1; --neutral-stroke-active: #636363; --neutral-stroke-focus: #7a7a7a; --neutral-stroke-divider-rest: #4f4f4f; --error-fill-rest: #e34e43; --error-fill-hover: #f5564b; --error-fill-active: #cd453b; --error-fill-focus: #e34e43; --error-foreground-rest: #f8837b; --error-foreground-hover: #f99a93; --error-foreground-active: #f7746b; --error-foreground-focus: #f8837b; --clear-button-hover: #616161; --clear-button-active: #5c5c5c;"><div class="lm-Widget lm-Panel jp-SidePanel-header"><h2 class="jp-text-truncated lm-Widget">__notebook_source__.ipynb</h2></div><jp-toolbar class="lm-Widget jp-Toolbar jp-SidePanel-toolbar" aria-label="side panel actions" aria-orientation="horizontal" orientation="horizontal" role="toolbar" style="min-height: var(--jp-private-toolbar-height);"><div class="lm-Widget jp-CommandToolbarButton jp-toc-numberingButton jp-Toolbar-item" data-jp-item-name="display-numbering"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="Show heading number in the document" aria-pressed="false" data-command="toc:display-numbering" title="Show heading number in the document" tabindex="0" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 28 28" data-icon="ui-components:numbering" class=""><g xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill="#616161"><path d="M4 19H6V19.5H5V20.5H6V21H4V22H7V18H4V19ZM5 10H6V6H4V7H5V10ZM4 13H5.8L4 15.1V16H7V15H5.2L7 12.9V12H4V13ZM9 7V9H23V7H9ZM9 21H23V19H9V21ZM9 15H23V13H9V15Z"></path></g></svg></jp-button></div><div class="lm-Widget jp-Toolbar-spacer jp-Toolbar-item" data-jp-item-name="spacer"></div><div class="lm-Widget jp-CommandToolbarButton jp-Toolbar-item" data-jp-item-name="collapse-all"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="Collapse All Headings" data-command="toc:toggle-collapse" title="Collapse All Headings" tabindex="-1" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 24 24" data-icon="ui-components:collapse-all" class=""><g xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill="#616161"><path d="M8 2c1 0 11 0 12 0s2 1 2 2c0 1 0 11 0 12s0 2-2 2C20 14 20 4 20 4S10 4 6 4c0-2 1-2 2-2z"></path><path d="M18 8c0-1-1-2-2-2S5 6 4 6s-2 1-2 2c0 1 0 11 0 12s1 2 2 2c1 0 11 0 12 0s2-1 2-2c0-1 0-11 0-12zm-2 0v12H4V8z"></path><path d="M6 13v2h8v-2z"></path></g></svg></jp-button></div><div class="lm-Widget jp-ToolbarButton jp-Toolbar-item" data-jp-item-name="submenu"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="More actionsâ€¦" aria-pressed="false" title="More actionsâ€¦" tabindex="-1" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" data-icon="ui-components:ellipses" class=""><g xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill="#616161"><circle cx="5" cy="12" r="2"></circle><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle></g></svg></jp-button></div></jp-toolbar><div class="lm-Widget lm-Panel jp-SidePanel-content" role="region" aria-label="side panel content"><div class="lm-Widget jp-TableOfContents-tree"><ol class="jp-TableOfContents-content" data-document-type="notebook"><li class="jp-tocItem"><div class="jp-tocItem-heading jp-tocItem-active"><button class="jp-tocItem-collapser" style="visibility: hidden;"><span class="f32gur5"><svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 18 18" data-icon="ui-components:caret-down"><g xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill="#616161" shape-rendering="geometricPrecision"><path d="M5.2,7.5L9,11.2l3.8-3.8H5.2z"></path></g></svg></span></button><span class="jp-tocItem-content" title="ðŸš€ Barbados Traffic Forecasting Challenge" data-running="-1">ðŸš€ Barbados Traffic Forecasting Challenge</span></div></li></ol></div></div></div></div></div><div class="lm-SplitPanel-handle lm-mod-hidden" style="position: absolute; contain: style;"></div><div class="lm-Widget lm-Panel lm-SplitPanel-child" data-direction="top-to-bottom" data-alignment="start" style="position: absolute; contain: strict; min-width: 0px; min-height: 0px; top: 0px; left: 0px; width: 696px; height: 621px;"><div class="lm-Widget lm-Panel lm-mod-hidden" id="top-panel-wrapper" style="position: absolute; contain: strict; top: 0px; left: 0px; width: 696px; height: 42px;"><div class="lm-Widget lm-Panel" id="top-panel" role="banner" style="--neutral-layer-card-container: #333333; --neutral-layer-floating: #4a4a4a; --neutral-layer-1: #3b3b3b; --neutral-layer-2: #333333; --neutral-layer-3: #2b2b2b; --neutral-layer-4: #242424; --fill-color: #3b3b3b; --accent-fill-rest: #3195e4; --accent-fill-hover: #36a0f4; --accent-fill-active: #2b87cf; --accent-fill-focus: #3195e4; --accent-foreground-rest: #4eabf5; --accent-foreground-hover: #6ab9f7; --accent-foreground-active: #3aa2f4; --accent-foreground-focus: #4eabf5; --neutral-fill-rest: #4c4c4c; --neutral-fill-hover: #545454; --neutral-fill-active: #474747; --neutral-fill-focus: #3b3b3b; --neutral-fill-input-rest: #3b3b3b; --neutral-fill-input-hover: #3b3b3b; --neutral-fill-input-active: #3b3b3b; --neutral-fill-input-focus: #3b3b3b; --neutral-fill-stealth-rest: #3b3b3b; --neutral-fill-stealth-hover: #474747; --neutral-fill-stealth-active: #424242; --neutral-fill-stealth-focus: #3b3b3b; --neutral-fill-strong-rest: #a7a7a7; --neutral-fill-strong-hover: #bbbbbb; --neutral-fill-strong-active: #9a9a9a; --neutral-fill-strong-focus: #a7a7a7; --neutral-fill-layer-rest: #424242; --focus-stroke-outer: #929292; --focus-stroke-inner: #0d3e65; --neutral-foreground-hint: #a7a7a7; --neutral-foreground-rest: #ffffff; --neutral-stroke-rest: #7a7a7a; --neutral-stroke-hover: #a1a1a1; --neutral-stroke-active: #636363; --neutral-stroke-focus: #7a7a7a; --neutral-stroke-divider-rest: #4f4f4f; --error-fill-rest: #e34e43; --error-fill-hover: #f5564b; --error-fill-active: #cd453b; --error-fill-focus: #e34e43; --error-foreground-rest: #f8837b; --error-foreground-hover: #f99a93; --error-foreground-active: #f7746b; --error-foreground-focus: #f8837b; --clear-button-hover: #616161; --clear-button-active: #5c5c5c;"><div class="lm-Widget jp-skiplink" id="jp-skiplink"><a href="#first-cell" tabindex="1" class="skip-link">Skip to Main</a></div><a href="https://kkb-production.jupyter-proxy.kaggle.net/tree" target="_blank" rel="noopener noreferrer" class="lm-Widget fj2oukb" id="jp-NotebookLogo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="189" height="51" version="2.0" viewBox="0 0 189 51" data-icon="notebook-ui-components:jupyter" data-icon-id="0b8de702-0580-45c4-8ee5-35f83fb2aa98"><title>Jupyter</title><g class="jp-icon3" transform="translate(-1638 -2093)" fill="#616161"><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1688.9 2106.2)" style="mix-blend-mode:normal" xlink:href="#path0_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1705.4 2106.2)" style="mix-blend-mode:normal" xlink:href="#path1_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1730.2 2105.7)" style="mix-blend-mode:normal" xlink:href="#path2_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1752.9 2106.2)" style="mix-blend-mode:normal" xlink:href="#path3_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1775.8 2100)" style="mix-blend-mode:normal" xlink:href="#path4_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1791.8 2105.7)" style="mix-blend-mode:normal" xlink:href="#path5_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1815.8 2105.7)" style="mix-blend-mode:normal" xlink:href="#path6_fill"></use></g></g></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1669.3 2093.3)" fill="#767677" style="mix-blend-mode:normal" xlink:href="#path7_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1639.7 2124)" fill="#F37726" style="mix-blend-mode:normal" xlink:href="#path8_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1639.7 2097.5)" fill="#F37726" style="mix-blend-mode:normal" xlink:href="#path9_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1639.8 2135.8)" fill="#989798" style="mix-blend-mode:normal" xlink:href="#path10_fill"></use></g></g><g style="mix-blend-mode:normal"><g style="mix-blend-mode:normal"><use transform="translate(1638.4 2098.1)" fill="#6F7070" style="mix-blend-mode:normal" xlink:href="#path11_fill"></use></g></g></g></g></g><defs><path id="path0_fill" d="m5.6259 17.928c0 5.1461-0.3925 6.8263-1.4392 8.0666-1.1426 1.0559-2.637 1.6399-4.1867 1.6362l0.39251 3.0612c2.402 0.0333 4.7305-0.8352 6.5331-2.4366 1.8753-1.9529 2.5295-4.6535 2.5295-8.7967v-19.458h-3.8378v17.954l0.00872-0.0264z"></path><path id="path1_fill" d="m17.741 15.623c0 2.2168 0 4.1696 0.1744 5.8498h-3.3581l-0.218-3.5187h-0.0873c-0.7069 1.2298-1.7261 2.2473-2.9526 2.9477-1.2265 0.7005-2.6159 1.0585-4.0252 1.0372-3.3145 0-7.2744-1.8649-7.2744-9.3948v-12.544h3.8378v11.902c0 4.0817 1.2211 6.8262 4.7014 6.8262 1.0917-0.0201 2.1533-0.3647 3.0516-0.9907 0.8984-0.6259 1.5936-1.5053 1.9986-2.5279 0.2328-0.6395 0.351-1.3157 0.3489-1.9969v-13.195h3.8379v15.605h-0.0349z"></path><path id="path2_fill" d="m0.17445 7.5363c0-2.7446-0.087223-4.9613-0.17445-7.0374h3.4453l0.17445 3.677h0.08722c0.75374-1.3174 1.85-2.4022 3.1705-3.137 1.3205-0.73485 2.8149-1.0919 4.322-1.0326 5.0939 0 8.9317 4.3983 8.9317 10.908 0 7.7147-4.6141 11.524-9.5946 11.524-1.2785 0.0541-2.5489-0.2281-3.6867-0.8187-1.1377-0.5907-2.1036-1.4696-2.8028-2.5504h-0.08723v11.656h-3.7942v-23.223l0.008722 0.03519zm3.7942 5.7179c0.01001 0.5349 0.0684 1.0679 0.17444 1.5922 0.31262 1.3003 1.0491 2.4571 2.0914 3.2849 1.0423 0.8279 2.33 1.2788 3.6567 1.2805 4.0559 0 6.4022-3.3691 6.4022-8.2864 0-4.3016-2.2242-7.9786-6.2714-7.9786-1.3611 0.03841-2.6704 0.53457-3.7198 1.4096-1.0494 0.87505-1.7786 2.0788-2.0718 3.4198-0.15373 0.51742-0.24166 1.0524-0.26167 1.5922v3.6858z"></path><path id="path3_fill" d="m4.1606 0 4.6141 12.676c0.47973 1.4163 1.0031 3.1053 1.352 4.3984h0.0872c0.3925-1.2843 0.8286-2.9293 1.352-4.4775l4.1867-12.588h4.0559l-5.7481 15.297c-2.7475 7.3541-4.6141 11.128-7.2308 13.433-1.3222 1.2403-2.9429 2.1106-4.7014 2.5246l-0.95946-3.2811c1.2303-0.4134 2.3704-1.0615 3.3581-1.9089 1.3957-1.1762 2.5006-2.664 3.2273-4.3456 0.15514-0.2904 0.25848-0.606 0.30528-0.9324-0.03445-0.3518-0.12272-0.696-0.26167-1.0205l-7.7978-19.766h4.1867l-0.02616-0.0087967z"></path><path id="path4_fill" d="m7.0215 0v6.1577h5.4864v2.9733h-5.4864v11.559c0 2.639 0.7414 4.1696 2.8784 4.1696 0.74972 0.0118 1.4976-0.077 2.2242-0.2639l0.1744 2.9293c-1.0915 0.3877-2.2451 0.5667-3.4017 0.5278-0.76701 0.0474-1.535-0.0744-2.2506-0.357-0.71554-0.2826-1.3614-0.7191-1.8925-1.2792-1.0903-1.1523-1.4828-3.0612-1.4828-5.5858v-11.7h-3.2709v-2.9733h3.2709v-5.1461l3.7506-1.0116z"></path><path id="path5_fill" d="m3.6285 11.928c0.08723 5.278 3.4017 7.4508 7.2308 7.4508 2.0019 0.0634 3.9934-0.3149 5.8353-1.1084l0.6542 2.7886c-2.2069 0.9347-4.585 1.3874-6.9779 1.3283-6.4894 0-10.371-4.3456-10.371-10.82 0-6.4743 3.7506-11.568 9.8912-11.568 6.8819 0 8.7223 6.1577 8.7223 10.107-0.0065 0.6091-0.0501 1.2172-0.1308 1.8209h-14.854zm11.243-2.7885c0.0436-2.4807-1.003-6.3424-5.3119-6.3424-3.8814 0-5.5736 3.633-5.8789 6.3424h11.199-0.0087z"></path><path id="path6_fill" d="m0.17445 7.1785c0-2.5246-0.043612-4.6974-0.17445-6.6943h3.3581l0.13083 4.2136h0.17445c0.95946-2.8853 3.2709-4.6974 5.8353-4.6974 0.36765-0.0054214 0.73435 0.038958 1.0902 0.13195v3.677c-0.4296-0.09447-0.86861-0.13874-1.3083-0.13195-2.7039 0-4.6141 2.0848-5.1375 5.0053-0.10796 0.60107-0.16631 1.2101-0.17445 1.8209v11.436h-3.7942v-14.761z"></path><path id="path7_fill" d="m5.8935 2.844c0.02536 0.58765-0.12268 1.1697-0.42538 1.6724-0.3027 0.50277-0.74647 0.9037-1.2752 1.1521-0.52869 0.24837-1.1186 0.333-1.6949 0.2432-0.57639-0.08981-1.1134-0.35001-1.5432-0.7477-0.42973-0.39768-0.73284-0.91498-0.87099-1.4864-0.13815-0.57146-0.10513-1.1714 0.094877-1.7239 0.20001-0.55254 0.55803-1.0328 1.0288-1.3801 0.47072-0.34728 1.033-0.54595 1.6157-0.57087 0.78063-0.033384 1.5425 0.24712 2.1182 0.77988 0.57569 0.53276 0.91814 1.2742 0.95211 2.0614z"></path><path id="path8_fill" d="m18.265 7.1341c-7.8501 0-14.706-2.8765-18.265-7.1341 1.3254 3.8204 3.7956 7.1308 7.0686 9.473 3.2731 2.3422 7.1871 3.6004 11.2 3.6004s7.9273-1.2582 11.2-3.6004c3.273-2.3422 5.7432-5.6526 7.0686-9.473-3.5675 4.2576-10.423 7.1341-18.273 7.1341z"></path><path id="path9_fill" d="m18.273 5.9393c7.8502 0 14.706 2.8765 18.265 7.1341-1.3254-3.8204-3.7956-7.1308-7.0686-9.473-3.2731-2.3422-7.1871-3.6004-11.2-3.6004s-7.9273 1.2582-11.2 3.6004c-3.273 2.3422-5.7432 5.6526-7.0686 9.473 3.5674-4.2488 10.423-7.1341 18.273-7.1341z"></path><path id="path10_fill" d="m7.4279 3.5834c0.03219 0.74092-0.15434 1.4748-0.53596 2.1088s-0.94118 1.1394-1.6078 1.4525c-0.66664 0.31303-1.4104 0.41954-2.1371 0.30603s-1.4037-0.44193-1.9452-0.94368c-0.54151-0.50175-0.92323-1.1543-1.0968-1.8749-0.17359-0.72067-0.13125-1.4771 0.12166-2.1735 0.25291-0.69639 0.70502-1.3014 1.2991-1.7385 0.59407-0.4371 1.3034-0.68659 2.0381-0.7169 0.98278-0.040537 1.9414 0.31357 2.6657 0.9847 0.72432 0.67112 1.1552 1.6045 1.1983 2.5955z"></path><path id="path11_fill" d="m2.2747 4.3963c-0.43108 0.01879-0.858-0.09184-1.2267-0.31786-0.36872-0.22603-0.66266-0.55729-0.84462-0.95187s-0.24375-0.83473-0.17756-1.2648c0.066192-0.43001 0.25739-0.83055 0.5494-1.1509 0.29201-0.32037 0.6717-0.54618 1.091-0.64882 0.41931-0.10265 0.85939-0.077531 1.2645 0.072176 0.40515 0.14971 0.75716 0.41727 1.0115 0.76882 0.2543 0.35156 0.39947 0.7713 0.41713 1.2061 0.02364 0.58191-0.18257 1.1495-0.57338 1.5783-0.39081 0.42878-0.93431 0.6837-1.5113 0.70883z"></path></defs></svg></a><jp-toolbar class="lm-Widget jp-Toolbar" id="jp-top-bar" aria-orientation="horizontal" orientation="horizontal" role="toolbar" style="min-height: var(--jp-private-toolbar-height);"><div class="lm-Widget jp-Toolbar-item" id="jp-title" data-jp-item-name="widgetTitle" style="margin-left: 10px;"><h1>__notebook_source__</h1></div><div class="lm-Widget jp-NotebookCheckpoint jp-Toolbar-item" id="id-ef342a79-4847-4706-a3e4-f16b890b46dc" data-jp-item-name="checkpoint">Last Checkpoint: now</div><div class="lm-Widget jp-Toolbar-spacer jp-Toolbar-item" data-jp-item-name="spacer"></div><div class="lm-Widget jp-NotebookKernelLogo jp-Toolbar-item" data-jp-item-name="kernelLogo"></div></jp-toolbar></div></div><div class="lm-Widget lm-Panel" id="menu-panel-wrapper" style="position: absolute; contain: strict; top: 0px; left: 0px; width: 696px; height: 0px;"><div class="lm-Widget lm-Panel" id="menu-panel" role="navigation"><div class="lm-Widget lm-MenuBar jp-scrollbar-tiny" id="jp-MainMenu"><ul class="lm-MenuBar-content" role="menubar"><li tabindex="0" role="menuitem" aria-haspopup="true" aria-disabled="false" class="lm-MenuBar-item"><div class="lm-MenuBar-itemIcon"></div><div class="lm-MenuBar-itemLabel">File</div></li><li tabindex="-1" role="menuitem" aria-haspopup="true" aria-disabled="false" class="lm-MenuBar-item"><div class="lm-MenuBar-itemIcon"></div><div class="lm-MenuBar-itemLabel">Edit</div></li><li tabindex="-1" role="menuitem" aria-haspopup="true" aria-disabled="false" class="lm-MenuBar-item"><div class="lm-MenuBar-itemIcon"></div><div class="lm-MenuBar-itemLabel">View</div></li><li tabindex="-1" role="menuitem" aria-haspopup="true" aria-disabled="false" class="lm-MenuBar-item"><div class="lm-MenuBar-itemIcon"></div><div class="lm-MenuBar-itemLabel">Run</div></li><li tabindex="-1" role="menuitem" aria-haspopup="true" aria-disabled="false" class="lm-MenuBar-item"><div class="lm-MenuBar-itemIcon"></div><div class="lm-MenuBar-itemLabel">Kernel</div></li><li tabindex="-1" role="menuitem" aria-haspopup="true" aria-disabled="false" class="lm-MenuBar-item"><div class="lm-MenuBar-itemIcon"></div><div class="lm-MenuBar-itemLabel">Settings</div></li><li tabindex="-1" role="menuitem" aria-haspopup="true" aria-disabled="false" class="lm-MenuBar-item"><div class="lm-MenuBar-itemIcon"></div><div class="lm-MenuBar-itemLabel">Help</div></li></ul></div><div class="lm-Widget jp-NotebookSpacer" id="id-50a1d804-f7a1-46f8-a603-ec5c52dbf724"></div><div class="lm-Widget jp-NotebookKernelStatus jp-NotebookKernelStatus-warn">Kernel Unknown</div><div class="lm-Widget"><button class="jp-NotebookTrustedStatus" title="JavaScript enabled for notebook display" style="cursor: help;">Trusted</button></div></div></div><div class="lm-Widget lm-mod-hidden" id="spacer-widget-top" style="position: absolute; contain: strict; top: 70px; left: 0px; width: 696px; height: 0px;"></div><div class="lm-Widget lm-Panel" id="main-panel" role="main" style="position: absolute; contain: strict; top: 0px; left: 0px; width: 696px; height: 621px;"><div class="lm-Widget jp-MainAreaWidget jp-NotebookPanel jp-Document jp-mod-searchable" id="id-9c581adb-e6c6-46a8-97f4-b05ccd54ba51" data-direction="top-to-bottom" data-alignment="start" style="min-width: 0px; min-height: 0px; --neutral-layer-card-container: #333333; --neutral-layer-floating: #4a4a4a; --neutral-layer-1: #3b3b3b; --neutral-layer-2: #333333; --neutral-layer-3: #2b2b2b; --neutral-layer-4: #242424; --fill-color: #3b3b3b; --accent-fill-rest: #3195e4; --accent-fill-hover: #36a0f4; --accent-fill-active: #2b87cf; --accent-fill-focus: #3195e4; --accent-foreground-rest: #4eabf5; --accent-foreground-hover: #6ab9f7; --accent-foreground-active: #3aa2f4; --accent-foreground-focus: #4eabf5; --neutral-fill-rest: #4c4c4c; --neutral-fill-hover: #545454; --neutral-fill-active: #474747; --neutral-fill-focus: #3b3b3b; --neutral-fill-input-rest: #3b3b3b; --neutral-fill-input-hover: #3b3b3b; --neutral-fill-input-active: #3b3b3b; --neutral-fill-input-focus: #3b3b3b; --neutral-fill-stealth-rest: #3b3b3b; --neutral-fill-stealth-hover: #474747; --neutral-fill-stealth-active: #424242; --neutral-fill-stealth-focus: #3b3b3b; --neutral-fill-strong-rest: #a7a7a7; --neutral-fill-strong-hover: #bbbbbb; --neutral-fill-strong-active: #9a9a9a; --neutral-fill-strong-focus: #a7a7a7; --neutral-fill-layer-rest: #424242; --focus-stroke-outer: #929292; --focus-stroke-inner: #0d3e65; --neutral-foreground-hint: #a7a7a7; --neutral-foreground-rest: #ffffff; --neutral-stroke-rest: #7a7a7a; --neutral-stroke-hover: #a1a1a1; --neutral-stroke-active: #636363; --neutral-stroke-focus: #7a7a7a; --neutral-stroke-divider-rest: #4f4f4f; --error-fill-rest: #e34e43; --error-fill-hover: #f5564b; --error-fill-active: #cd453b; --error-fill-focus: #e34e43; --error-foreground-rest: #f8837b; --error-foreground-hover: #f99a93; --error-foreground-active: #f7746b; --error-foreground-focus: #f8837b; --clear-button-hover: #616161; --clear-button-active: #5c5c5c;"><jp-toolbar class="lm-Widget jp-Toolbar jp-NotebookPanel-toolbar" role="toolbar" aria-label="notebook actions" aria-orientation="horizontal" orientation="horizontal" style="position: absolute; contain: strict; min-height: var(--jp-private-toolbar-height); top: 0px; left: 0px; width: 696px; height: 260.5px;"><div class="lm-Widget jp-ToolbarButton jp-Toolbar-responsive-opener jp-Toolbar-item" data-jp-item-name="toolbar-popup-opener"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="More commands" aria-pressed="false" title="More commands" tabindex="0" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" data-icon="ui-components:ellipses" class=""><g xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill="#616161"><circle cx="5" cy="12" r="2"></circle><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle></g></svg></jp-button></div></jp-toolbar><div class="lm-Widget lm-Panel lm-BoxPanel" data-direction="top-to-bottom" data-alignment="start" style="position: absolute; contain: strict; top: 260.5px; left: 0px; width: 696px; height: 260.5px; min-width: 0px; min-height: 0px;"></div><div class="jp-WindowedPanel lm-Widget jp-Notebook jp-mod-scrollPastEnd jp-mod-showHiddenCellsButton jp-NotebookPanel-notebook jp-mod-commandMode" data-jp-kernel-user="true" data-jp-undoer="true" data-jp-code-runner="true" role="region" aria-label="notebook content" id="id-6fb27113-7f08-4661-bc79-94eb7046fb3f" tabindex="-1" style="position: absolute; contain: strict; top: 521px; left: 0px; width: 696px; height: 100px;"><div class="jp-WindowedPanel-scrollbar"><ol class="jp-WindowedPanel-scrollbar-content"></ol></div><div class="jp-WindowedPanel-outer" data-lm-dragscroll="true"><div class="jp-WindowedPanel-inner"><div role="feed" aria-label="Cells" class="jp-WindowedPanel-viewport" style="position: relative; top: 0px;"><div class="lm-Widget jp-Cell jp-MarkdownCell jp-Notebook-cell jp-mod-rendered" aria-label="Markdown Cell Content" data-windowed-list-index="0" tabindex="-1" data-bootstrap="done" data-uuid="d292ae21-d191-4ac3-8221-0caf27270dd6" id="d292ae21-d191-4ac3-8221-0caf27270dd6"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea" style="--neutral-layer-card-container: #333333; --neutral-layer-floating: #4a4a4a; --neutral-layer-1: #3b3b3b; --neutral-layer-2: #333333; --neutral-layer-3: #2b2b2b; --neutral-layer-4: #242424; --fill-color: #3b3b3b; --accent-fill-rest: #3195e4; --accent-fill-hover: #36a0f4; --accent-fill-active: #2b87cf; --accent-fill-focus: #3195e4; --accent-foreground-rest: #4eabf5; --accent-foreground-hover: #6ab9f7; --accent-foreground-active: #3aa2f4; --accent-foreground-focus: #4eabf5; --neutral-fill-rest: #4c4c4c; --neutral-fill-hover: #545454; --neutral-fill-active: #474747; --neutral-fill-focus: #3b3b3b; --neutral-fill-input-rest: #3b3b3b; --neutral-fill-input-hover: #3b3b3b; --neutral-fill-input-active: #3b3b3b; --neutral-fill-input-focus: #3b3b3b; --neutral-fill-stealth-rest: #3b3b3b; --neutral-fill-stealth-hover: #474747; --neutral-fill-stealth-active: #424242; --neutral-fill-stealth-focus: #3b3b3b; --neutral-fill-strong-rest: #a7a7a7; --neutral-fill-strong-hover: #bbbbbb; --neutral-fill-strong-active: #9a9a9a; --neutral-fill-strong-focus: #a7a7a7; --neutral-fill-layer-rest: #424242; --focus-stroke-outer: #929292; --focus-stroke-inner: #0d3e65; --neutral-foreground-hint: #a7a7a7; --neutral-foreground-rest: #ffffff; --neutral-stroke-rest: #7a7a7a; --neutral-stroke-hover: #a1a1a1; --neutral-stroke-active: #636363; --neutral-stroke-focus: #7a7a7a; --neutral-stroke-divider-rest: #4f4f4f; --error-fill-rest: #e34e43; --error-fill-hover: #f5564b; --error-fill-active: #cd453b; --error-fill-focus: #e34e43; --error-foreground-rest: #f8837b; --error-foreground-hover: #f99a93; --error-foreground-active: #f7746b; --error-foreground-focus: #f8837b; --clear-button-hover: #616161; --clear-button-active: #5c5c5c;"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt"><button class="jp-Button jp-collapseHeadingButton" data-heading-level="1"></button></div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor lm-mod-hidden" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 332px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">99</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 26.3176px;">2</div><div class="cm-gutterElement" style="height: 26.618px;">3</div><div class="cm-gutterElement" style="height: 31.7253px;">4</div><div class="cm-gutterElement" style="height: 28.1202px;">5</div><div class="cm-gutterElement" style="height: 27.5193px;">6</div><div class="cm-gutterElement" style="height: 26.9185px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 17.6052px;">9</div><div class="cm-gutterElement" style="height: 35.03px;">10</div><div class="cm-gutterElement" style="height: 29.0215px;">11</div><div class="cm-gutterElement" style="height: 31.7253px;">12</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content cm-lineWrapping" role="textbox" aria-multiline="true" tabindex="-1" style="tab-size: 4;" data-language="markdown"><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼u">ðŸš€ Barbados Traffic Forecasting Challenge</span></div><div class="cm-line"><span class="Í¼u Í¼s">==========================================</span></div><div class="cm-line">Task: Predict congestion 5 minutes into future (T+3 to T+7)</div><div class="cm-line">Input: 15 minutes of video features (T-14 to T)</div><div class="cm-line">Embargo: 2 minutes (T+1, T+2) - not available</div><div class="cm-line">Output: 5 minutes (T+3, T+4, T+5, T+6, T+7)</div><div class="cm-line"><br></div><div class="cm-line">Constraints:</div><div class="cm-line"><span class="Í¼s">-</span> No backpropagation for forecasting (no using future to predict past)</div><div class="cm-line"><span class="Í¼s">-</span> Real-time deployment: sequential prediction only</div><div class="cm-line"><span class="Í¼s">-</span> Reuse existing extracted features (no video reprocessing)</div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div><div class="lm-Widget jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown"><h1 id="ðŸš€-Barbados-Traffic-Forecasting-Challenge"><span class="numbering-entry"></span>ðŸš€ Barbados Traffic Forecasting Challenge<a target="_self" href="#ðŸš€-Barbados-Traffic-Forecasting-Challenge" class="jp-InternalAnchorLink">Â¶</a></h1>
<p>Task: Predict congestion 5 minutes into future (T+3 to T+7)
Input: 15 minutes of video features (T-14 to T)
Embargo: 2 minutes (T+1, T+2) - not available
Output: 5 minutes (T+3, T+4, T+5, T+6, T+7)</p>
<p>Constraints:</p>
<ul>
<li>No backpropagation for forecasting (no using future to predict past)</li>
<li>Real-time deployment: sequential prediction only</li>
<li>Reuse existing extracted features (no video reprocessing)</li>
</ul>
</div></div></div><div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-selected jp-mod-active" aria-label="Code Cell Content with Output" tabindex="0" data-windowed-list-index="1" data-bootstrap="done" data-uuid="0c9a0918-6566-40c5-8782-9f53a1e2d20d" id="0c9a0918-6566-40c5-8782-9f53a1e2d20d"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea" style="--neutral-layer-card-container: #333333; --neutral-layer-floating: #4a4a4a; --neutral-layer-1: #3b3b3b; --neutral-layer-2: #333333; --neutral-layer-3: #2b2b2b; --neutral-layer-4: #242424; --fill-color: #3b3b3b; --accent-fill-rest: #3195e4; --accent-fill-hover: #36a0f4; --accent-fill-active: #2b87cf; --accent-fill-focus: #3195e4; --accent-foreground-rest: #4eabf5; --accent-foreground-hover: #6ab9f7; --accent-foreground-active: #3aa2f4; --accent-foreground-focus: #4eabf5; --neutral-fill-rest: #4c4c4c; --neutral-fill-hover: #545454; --neutral-fill-active: #474747; --neutral-fill-focus: #3b3b3b; --neutral-fill-input-rest: #3b3b3b; --neutral-fill-input-hover: #3b3b3b; --neutral-fill-input-active: #3b3b3b; --neutral-fill-input-focus: #3b3b3b; --neutral-fill-stealth-rest: #3b3b3b; --neutral-fill-stealth-hover: #474747; --neutral-fill-stealth-active: #424242; --neutral-fill-stealth-focus: #3b3b3b; --neutral-fill-strong-rest: #a7a7a7; --neutral-fill-strong-hover: #bbbbbb; --neutral-fill-strong-active: #9a9a9a; --neutral-fill-strong-focus: #a7a7a7; --neutral-fill-layer-rest: #424242; --focus-stroke-outer: #929292; --focus-stroke-inner: #0d3e65; --neutral-foreground-hint: #a7a7a7; --neutral-foreground-rest: #ffffff; --neutral-stroke-rest: #7a7a7a; --neutral-stroke-hover: #a1a1a1; --neutral-stroke-active: #636363; --neutral-stroke-focus: #7a7a7a; --neutral-stroke-divider-rest: #4f4f4f; --error-fill-rest: #e34e43; --error-fill-hover: #f5564b; --error-fill-active: #cd453b; --error-fill-focus: #e34e43; --error-foreground-rest: #f8837b; --error-foreground-hover: #f99a93; --error-foreground-active: #f7746b; --error-foreground-focus: #f8837b; --clear-button-hover: #616161; --clear-button-active: #5c5c5c;"><jp-toolbar class="lm-Widget jp-Toolbar jp-cell-menu jp-cell-toolbar" aria-orientation="horizontal" orientation="horizontal" role="toolbar" style="min-height: var(--jp-private-toolbar-height);"><div class="lm-Widget jp-CommandToolbarButton jp-Toolbar-item" data-jp-item-name="duplicate-cell"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="Create a duplicate of this cell below" data-command="notebook:duplicate-below" title="Create a duplicate of this cell below" tabindex="0" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none" data-icon="ui-components:duplicate" class=""><path xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill-rule="evenodd" clip-rule="evenodd" d="M2.79998 0.875H8.89582C9.20061 0.875 9.44998 1.13914 9.44998 1.46198C9.44998 1.78482 9.20061 2.04896 8.89582 2.04896H3.35415C3.04936 2.04896 2.79998 2.3131 2.79998 2.63594V9.67969C2.79998 10.0025 2.55061 10.2667 2.24582 10.2667C1.94103 10.2667 1.69165 10.0025 1.69165 9.67969V2.04896C1.69165 1.40328 2.1904 0.875 2.79998 0.875ZM5.36665 11.9V4.55H11.0833V11.9H5.36665ZM4.14165 4.14167C4.14165 3.69063 4.50728 3.325 4.95832 3.325H11.4917C11.9427 3.325 12.3083 3.69063 12.3083 4.14167V12.3083C12.3083 12.7594 11.9427 13.125 11.4917 13.125H4.95832C4.50728 13.125 4.14165 12.7594 4.14165 12.3083V4.14167Z" fill="#616161"></path><path xmlns="http://www.w3.org/2000/svg" class="jp-icon3" d="M9.43574 8.26507H8.36431V9.3365C8.36431 9.45435 8.26788 9.55078 8.15002 9.55078C8.03217 9.55078 7.93574 9.45435 7.93574 9.3365V8.26507H6.86431C6.74645 8.26507 6.65002 8.16864 6.65002 8.05078C6.65002 7.93292 6.74645 7.8365 6.86431 7.8365H7.93574V6.76507C7.93574 6.64721 8.03217 6.55078 8.15002 6.55078C8.26788 6.55078 8.36431 6.64721 8.36431 6.76507V7.8365H9.43574C9.5536 7.8365 9.65002 7.93292 9.65002 8.05078C9.65002 8.16864 9.5536 8.26507 9.43574 8.26507Z" fill="#616161" stroke="#616161" stroke-width="0.5"></path></svg></jp-button></div><div class="lm-Widget jp-CommandToolbarButton jp-Toolbar-item" data-jp-item-name="move-cell-up"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="Move this cell up (Ctrl+Shift+Up)" data-command="notebook:move-cell-up" title="Move this cell up (Ctrl+Shift+Up)" tabindex="-1" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none" data-icon="ui-components:move-up" class=""><path xmlns="http://www.w3.org/2000/svg" class="jp-icon3" d="M1.52899 6.47101C1.23684 6.76316 1.23684 7.23684 1.52899 7.52899V7.52899C1.82095 7.82095 2.29426 7.82116 2.58649 7.52946L6.25 3.8725V12.25C6.25 12.6642 6.58579 13 7 13V13C7.41421 13 7.75 12.6642 7.75 12.25V3.8725L11.4027 7.53178C11.6966 7.82619 12.1736 7.82641 12.4677 7.53226V7.53226C12.7617 7.2383 12.7617 6.7617 12.4677 6.46774L7.70711 1.70711C7.31658 1.31658 6.68342 1.31658 6.29289 1.70711L1.52899 6.47101Z" fill="#616161"></path></svg></jp-button></div><div class="lm-Widget jp-CommandToolbarButton jp-Toolbar-item" data-jp-item-name="move-cell-down"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="Move this cell down (Ctrl+Shift+Down)" data-command="notebook:move-cell-down" title="Move this cell down (Ctrl+Shift+Down)" tabindex="-1" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none" data-icon="ui-components:move-down" class=""><path xmlns="http://www.w3.org/2000/svg" class="jp-icon3" d="M12.471 7.52899C12.7632 7.23684 12.7632 6.76316 12.471 6.47101V6.47101C12.179 6.17905 11.7057 6.17884 11.4135 6.47054L7.75 10.1275V1.75C7.75 1.33579 7.41421 1 7 1V1C6.58579 1 6.25 1.33579 6.25 1.75V10.1275L2.59726 6.46822C2.30338 6.17381 1.82641 6.17359 1.53226 6.46774V6.46774C1.2383 6.7617 1.2383 7.2383 1.53226 7.53226L6.29289 12.2929C6.68342 12.6834 7.31658 12.6834 7.70711 12.2929L12.471 7.52899Z" fill="#616161"></path></svg></jp-button></div><div class="lm-Widget jp-CommandToolbarButton jp-Toolbar-item" data-jp-item-name="insert-cell-above"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="Insert a cell above (A)" data-command="notebook:insert-cell-above" title="Insert a cell above (A)" tabindex="-1" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none" data-icon="ui-components:add-above" class=""><g xmlns="http://www.w3.org/2000/svg" clip-path="url(#clip0_137_19492)"><path class="jp-icon3" d="M4.75 4.93066H6.625V6.80566C6.625 7.01191 6.79375 7.18066 7 7.18066C7.20625 7.18066 7.375 7.01191 7.375 6.80566V4.93066H9.25C9.45625 4.93066 9.625 4.76191 9.625 4.55566C9.625 4.34941 9.45625 4.18066 9.25 4.18066H7.375V2.30566C7.375 2.09941 7.20625 1.93066 7 1.93066C6.79375 1.93066 6.625 2.09941 6.625 2.30566V4.18066H4.75C4.54375 4.18066 4.375 4.34941 4.375 4.55566C4.375 4.76191 4.54375 4.93066 4.75 4.93066Z" fill="#616161" stroke="#616161" stroke-width="0.7"></path></g><path xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill-rule="evenodd" clip-rule="evenodd" d="M11.5 9.5V11.5L2.5 11.5V9.5L11.5 9.5ZM12 8C12.5523 8 13 8.44772 13 9V12C13 12.5523 12.5523 13 12 13L2 13C1.44772 13 1 12.5523 1 12V9C1 8.44772 1.44771 8 2 8L12 8Z" fill="#616161"></path><defs xmlns="http://www.w3.org/2000/svg"><clipPath id="clip0_137_19492"><rect class="jp-icon3" width="6" height="6" fill="white" transform="matrix(-1 0 0 1 10 1.55566)"></rect></clipPath></defs></svg></jp-button></div><div class="lm-Widget jp-CommandToolbarButton jp-Toolbar-item" data-jp-item-name="insert-cell-below"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="Insert a cell below (B)" data-command="notebook:insert-cell-below" title="Insert a cell below (B)" tabindex="-1" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none" data-icon="ui-components:add-below" class=""><g xmlns="http://www.w3.org/2000/svg" clip-path="url(#clip0_137_19498)"><path class="jp-icon3" d="M9.25 10.0693L7.375 10.0693L7.375 8.19434C7.375 7.98809 7.20625 7.81934 7 7.81934C6.79375 7.81934 6.625 7.98809 6.625 8.19434L6.625 10.0693L4.75 10.0693C4.54375 10.0693 4.375 10.2381 4.375 10.4443C4.375 10.6506 4.54375 10.8193 4.75 10.8193L6.625 10.8193L6.625 12.6943C6.625 12.9006 6.79375 13.0693 7 13.0693C7.20625 13.0693 7.375 12.9006 7.375 12.6943L7.375 10.8193L9.25 10.8193C9.45625 10.8193 9.625 10.6506 9.625 10.4443C9.625 10.2381 9.45625 10.0693 9.25 10.0693Z" fill="#616161" stroke="#616161" stroke-width="0.7"></path></g><path xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill-rule="evenodd" clip-rule="evenodd" d="M2.5 5.5L2.5 3.5L11.5 3.5L11.5 5.5L2.5 5.5ZM2 7C1.44772 7 1 6.55228 1 6L1 3C1 2.44772 1.44772 2 2 2L12 2C12.5523 2 13 2.44772 13 3L13 6C13 6.55229 12.5523 7 12 7L2 7Z" fill="#616161"></path><defs xmlns="http://www.w3.org/2000/svg"><clipPath id="clip0_137_19498"><rect class="jp-icon3" width="6" height="6" fill="white" transform="matrix(1 1.74846e-07 1.74846e-07 -1 4 13.4443)"></rect></clipPath></defs></svg></jp-button></div><div class="lm-Widget jp-CommandToolbarButton jp-Toolbar-item" data-jp-item-name="delete-cell"><jp-button class="jp-ToolbarButtonComponent" aria-disabled="false" aria-label="Delete this cell (D, D)" data-command="notebook:delete-cell" title="Delete this cell (D, D)" tabindex="-1" current-value="" appearance="stealth" minimal=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16px" height="16px" data-icon="ui-components:delete" class=""><path xmlns="http://www.w3.org/2000/svg" d="M0 0h24v24H0z" fill="none"></path><path xmlns="http://www.w3.org/2000/svg" class="jp-icon3" fill="#626262" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg></jp-button></div></jp-toolbar><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[1]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 16824px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 20px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 20px;">2</div><div class="cm-gutterElement" style="height: 20px;">3</div><div class="cm-gutterElement" style="height: 20px;">4</div><div class="cm-gutterElement" style="height: 20px;">5</div><div class="cm-gutterElement" style="height: 20px;">6</div><div class="cm-gutterElement" style="height: 20px;">7</div><div class="cm-gutterElement" style="height: 20px;">8</div><div class="cm-gutterElement" style="height: 20px;">9</div><div class="cm-gutterElement" style="height: 20px;">10</div><div class="cm-gutterElement" style="height: 20px;">11</div><div class="cm-gutterElement" style="height: 20px;">12</div><div class="cm-gutterElement" style="height: 20px;">13</div><div class="cm-gutterElement" style="height: 20px;">14</div><div class="cm-gutterElement" style="height: 20px;">15</div><div class="cm-gutterElement" style="height: 20px;">16</div><div class="cm-gutterElement" style="height: 20px;">17</div><div class="cm-gutterElement" style="height: 20px;">18</div><div class="cm-gutterElement" style="height: 20px;">19</div><div class="cm-gutterElement" style="height: 20px;">20</div><div class="cm-gutterElement" style="height: 20px;">21</div><div class="cm-gutterElement" style="height: 20px;">22</div><div class="cm-gutterElement" style="height: 20px;">23</div><div class="cm-gutterElement" style="height: 20px;">24</div><div class="cm-gutterElement" style="height: 20px;">25</div><div class="cm-gutterElement" style="height: 20px;">26</div><div class="cm-gutterElement" style="height: 20px;">27</div><div class="cm-gutterElement" style="height: 20px;">28</div><div class="cm-gutterElement" style="height: 20px;">29</div><div class="cm-gutterElement" style="height: 20px;">30</div><div class="cm-gutterElement" style="height: 20px;">31</div><div class="cm-gutterElement" style="height: 20px;">32</div><div class="cm-gutterElement" style="height: 20px;">33</div><div class="cm-gutterElement" style="height: 20px;">34</div><div class="cm-gutterElement" style="height: 20px;">35</div><div class="cm-gutterElement" style="height: 20px;">36</div><div class="cm-gutterElement" style="height: 20px;">37</div><div class="cm-gutterElement" style="height: 20px;">38</div><div class="cm-gutterElement" style="height: 20px;">39</div><div class="cm-gutterElement" style="height: 20px;">40</div><div class="cm-gutterElement" style="height: 20px;">41</div><div class="cm-gutterElement" style="height: 20px;">42</div><div class="cm-gutterElement" style="height: 20px;">43</div><div class="cm-gutterElement" style="height: 20px;">44</div><div class="cm-gutterElement" style="height: 20px;">45</div><div class="cm-gutterElement" style="height: 20px;">46</div><div class="cm-gutterElement" style="height: 20px;">47</div><div class="cm-gutterElement" style="height: 20px;">48</div><div class="cm-gutterElement" style="height: 20px;">49</div><div class="cm-gutterElement" style="height: 20px;">50</div><div class="cm-gutterElement" style="height: 20px;">51</div><div class="cm-gutterElement" style="height: 20px;">52</div><div class="cm-gutterElement" style="height: 20px;">53</div><div class="cm-gutterElement" style="height: 20px;">54</div><div class="cm-gutterElement" style="height: 20px;">55</div><div class="cm-gutterElement" style="height: 20px;">56</div><div class="cm-gutterElement" style="height: 20px;">57</div><div class="cm-gutterElement" style="height: 20px;">58</div><div class="cm-gutterElement" style="height: 20px;">59</div><div class="cm-gutterElement" style="height: 20px;">60</div><div class="cm-gutterElement" style="height: 20px;">61</div><div class="cm-gutterElement" style="height: 20px;">62</div><div class="cm-gutterElement" style="height: 20px;">63</div><div class="cm-gutterElement" style="height: 20px;">64</div><div class="cm-gutterElement" style="height: 20px;">65</div><div class="cm-gutterElement" style="height: 20px;">66</div><div class="cm-gutterElement" style="height: 20px;">67</div><div class="cm-gutterElement" style="height: 20px;">68</div><div class="cm-gutterElement" style="height: 20px;">69</div><div class="cm-gutterElement" style="height: 20px;">70</div><div class="cm-gutterElement" style="height: 20px;">71</div><div class="cm-gutterElement" style="height: 20px;">72</div><div class="cm-gutterElement" style="height: 20px;">73</div><div class="cm-gutterElement" style="height: 20px;">74</div><div class="cm-gutterElement" style="height: 20px;">75</div><div class="cm-gutterElement" style="height: 20px;">76</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4; flex-basis: 1007px;"><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">Enhanced Feature Selection Pipeline</span></div><div class="cm-line"><span class="Í¼15">1. Smart progressive overlap (1â†’8 stride)</span></div><div class="cm-line"><span class="Í¼15">2. Time-based train/val split</span></div><div class="cm-line"><span class="Í¼15">3. Per-camera predictions with camera ID features</span></div><div class="cm-line"><span class="Í¼15">4. Camera-specific features utilized</span></div><div class="cm-line"><span class="Í¼15">5. Feature selection before full sequence creation</span></div><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼v">import</span> warnings</div><div class="cm-line">warnings<span class="Í¼1c">.</span><span class="Í¼12">filterwarnings</span><span class="Í¼1c">(</span><span class="Í¼15">'ignore'</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">import</span> os</div><div class="cm-line"><span class="Í¼v">import</span> pickle</div><div class="cm-line"><span class="Í¼v">import</span> numpy <span class="Í¼v">as</span> np</div><div class="cm-line"><span class="Í¼v">import</span> pandas <span class="Í¼v">as</span> pd</div><div class="cm-line"><span class="Í¼v">from</span> sklearn<span class="Í¼1c">.</span>ensemble <span class="Í¼v">import</span> ExtraTreesClassifier</div><div class="cm-line"><span class="Í¼v">from</span> sklearn<span class="Í¼1c">.</span>preprocessing <span class="Í¼v">import</span> LabelEncoder</div><div class="cm-line"><span class="Í¼v">from</span> sklearn<span class="Í¼1c">.</span>metrics <span class="Í¼v">import</span> f1_score<span class="Í¼1c">,</span> accuracy_score</div><div class="cm-line"><span class="Í¼v">import</span> gc</div><div class="cm-line"><span class="Í¼v">from</span> tqdm <span class="Í¼v">import</span> tqdm</div><div class="cm-line"><span class="Í¼v">from</span> IPython<span class="Í¼1c">.</span>display <span class="Í¼v">import</span> FileLink</div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># best: time based + et -&gt; 0.77</span></div><div class="cm-line"><span class="Í¼14"># trying now: time_based + xgb -&gt; 0.758818902 wtf</span></div><div class="cm-line"><span class="Í¼14"># trying next: interleaved + xgb -&gt;</span></div><div class="cm-line"><span class="Í¼14"># trying at the end: interleaved + et: confirm 0.75</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># TEST Cofig</span></div><div class="cm-line">SPLIT_METHOD <span class="Í¼13">=</span> <span class="Í¼15">'interleaved'</span> <span class="Í¼14"># time_based or interleaved</span></div><div class="cm-line">MODEL_TO_TRAIN <span class="Í¼13">=</span> <span class="Í¼15">'xgb'</span> <span class="Í¼14"># xgb, et, (lgbm soon)</span></div><div class="cm-line">USE_VOTING_FEATURE_SELECTION <span class="Í¼13">=</span> <span class="Í¼1g">False</span></div><div class="cm-line">USE_TEMPORAL_STATS <span class="Í¼13">=</span> <span class="Í¼1g">True</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Configuration</span></div><div class="cm-line">FEATURES_PATH <span class="Í¼13">=</span> <span class="Í¼15">'/kaggle/working/features'</span></div><div class="cm-line">TRAIN_FEATURES_FILE <span class="Í¼13">=</span> <span class="Í¼15">'/kaggle/input/features-dataset/train_segment_features.pkl'</span></div><div class="cm-line">TEST_FEATURES_FILE <span class="Í¼13">=</span> <span class="Í¼15">'/kaggle/input/features-dataset/test_segment_features.pkl'</span></div><div class="cm-line">LE_FILE <span class="Í¼13">=</span> <span class="Í¼15">'/kaggle/input/features-dataset/label_encoder.pkl'</span></div><div class="cm-line">TEMP_DIR <span class="Í¼13">=</span> <span class="Í¼15">'/kaggle/tmp/feature_selection'</span></div><div class="cm-line">OUTPUT_PATH <span class="Í¼13">=</span> <span class="Í¼15">'/kaggle/working/features'</span></div><div class="cm-line">INPUT_PATH <span class="Í¼13">=</span> <span class="Í¼15">'/kaggle/input/normanniles1-barbados-traffic'</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Forecasting parameters</span></div><div class="cm-line">LOOKBACK_WINDOW <span class="Í¼13">=</span> <span class="Í¼x">15</span></div><div class="cm-line">FORECAST_HORIZON <span class="Í¼13">=</span> <span class="Í¼x">5</span></div><div class="cm-line">EMBARGO_GAP <span class="Í¼13">=</span> <span class="Í¼x">2</span></div><div class="cm-line">TOTAL_WINDOW <span class="Í¼13">=</span> LOOKBACK_WINDOW <span class="Í¼13">+</span> EMBARGO_GAP <span class="Í¼13">+</span> FORECAST_HORIZON  <span class="Í¼14"># 22</span></div><div class="cm-line"><br></div><div class="cm-line">SAVE_FILES <span class="Í¼13">=</span> <span class="Í¼1g">False</span></div><div class="cm-line"><br></div><div class="cm-line">os<span class="Í¼1c">.</span><span class="Í¼12">makedirs</span><span class="Í¼1c">(</span>TEMP_DIR<span class="Í¼1c">,</span> exist_ok<span class="Í¼13">=</span><span class="Í¼1g">True</span><span class="Í¼1c">)</span></div><div class="cm-line">os<span class="Í¼1c">.</span><span class="Í¼12">makedirs</span><span class="Í¼1c">(</span>OUTPUT_PATH<span class="Í¼1c">,</span> exist_ok<span class="Í¼13">=</span><span class="Í¼1g">True</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Load dataframes</span></div><div class="cm-line">train_df <span class="Í¼13">=</span> pd<span class="Í¼1c">.</span><span class="Í¼12">read_csv</span><span class="Í¼1c">(</span>INPUT_PATH <span class="Í¼13">+</span> <span class="Í¼15">'/Train.csv'</span><span class="Í¼1c">)</span></div><div class="cm-line">test_input <span class="Í¼13">=</span> pd<span class="Í¼1c">.</span><span class="Í¼12">read_csv</span><span class="Í¼1c">(</span>INPUT_PATH <span class="Í¼13">+</span> <span class="Í¼15">'/TestInputSegments.csv'</span><span class="Í¼1c">)</span></div><div class="cm-line">sample_submission <span class="Í¼13">=</span> pd<span class="Í¼1c">.</span><span class="Í¼12">read_csv</span><span class="Í¼1c">(</span>INPUT_PATH <span class="Í¼13">+</span> <span class="Í¼15">'/SampleSubmission.csv'</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Parse timestamps</span></div><div class="cm-line"><span class="Í¼v">for</span> df <span class="Í¼v">in</span> <span class="Í¼17">[</span>train_df<span class="Í¼1c">,</span> test_input<span class="Í¼17">]</span>:</div><div class="cm-line">    df<span class="Í¼17">[</span><span class="Í¼15">'video_time'</span><span class="Í¼17">]</span> <span class="Í¼13">=</span> pd<span class="Í¼1c">.</span><span class="Í¼12">to_datetime</span><span class="Í¼1c">(</span>df<span class="Í¼17">[</span><span class="Í¼15">'video_time'</span><span class="Í¼17">]</span><span class="Í¼1c">)</span></div><div class="cm-line">    df<span class="Í¼17">[</span><span class="Í¼15">'date'</span><span class="Í¼17">]</span> <span class="Í¼13">=</span> pd<span class="Í¼1c">.</span><span class="Í¼12">to_datetime</span><span class="Í¼1c">(</span>df<span class="Í¼17">[</span><span class="Í¼15">'date'</span><span class="Í¼17">]</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"âœ… Train dataframe: </span><span class="Í¼17">{</span>train_df<span class="Í¼1c">.</span><span class="Í¼12">shape</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"âœ… Test input dataframe: </span><span class="Í¼17">{</span>test_input<span class="Í¼1c">.</span><span class="Í¼12">shape</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"âœ… Sample submission: </span><span class="Í¼17">{</span>sample_submission<span class="Í¼1c">.</span><span class="Í¼12">shape</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Load label encoder</span></div><div class="cm-line"><span class="Í¼v">with</span> <span class="cm-builtin">open</span><span class="Í¼1c">(</span>LE_FILE<span class="Í¼1c">,</span> <span class="Í¼15">'rb'</span><span class="Í¼1c">)</span> <span class="Í¼v">as</span> f:</div><div class="cm-line">    le <span class="Í¼13">=</span> pickle<span class="Í¼1c">.</span><span class="Í¼12">load</span><span class="Í¼1c">(</span>f<span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Encode labels in train_df</span></div><div class="cm-line">train_df<span class="Í¼17">[</span><span class="Í¼15">'congestion_enter_encoded'</span><span class="Í¼17">]</span> <span class="Í¼13">=</span> le<span class="Í¼1c">.</span><span class="Í¼12">transform</span><span class="Í¼1c">(</span>train_df<span class="Í¼17">[</span><span class="Í¼15">'congestion_enter_rating'</span><span class="Í¼17">]</span><span class="Í¼1c">)</span></div><div class="cm-line">train_df<span class="Í¼17">[</span><span class="Í¼15">'congestion_exit_encoded'</span><span class="Í¼17">]</span> <span class="Í¼13">=</span> le<span class="Í¼1c">.</span><span class="Í¼12">transform</span><span class="Í¼1c">(</span>train_df<span class="Í¼17">[</span><span class="Í¼15">'congestion_exit_rating'</span><span class="Í¼17">]</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Camera to ID mapping</span></div><div class="cm-gap" style="height: 15280px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms; animation-name: cm-blink2;"><div class="cm-cursor cm-cursor-primary" style="left: 40.0972px; top: 432px; height: 18.6667px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>âœ… Train dataframe: (16076, 14)
âœ… Test input dataframe: (2640, 14)
âœ… Sample submission: (1760, 3)

================================================================================
ðŸ“Š CAMERA ENCODING
================================================================================
  Norman Niles #1: 0
  Norman Niles #2: 1
  Norman Niles #3: 2
  Norman Niles #4: 3

================================================================================
âœ… SETUP COMPLETE - Ready to process data
================================================================================
</pre></div></div><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell" aria-label="Code Cell Content with Output" tabindex="-1" data-windowed-list-index="2" data-uuid="23ecd973-a4fd-4290-a578-783d1d1c4064" id="23ecd973-a4fd-4290-a578-783d1d1c4064" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[2]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 4294px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div><div class="cm-gutterElement" style="height: 14px;">6</div><div class="cm-gutterElement" style="height: 14px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 14px;">9</div><div class="cm-gutterElement" style="height: 14px;">10</div><div class="cm-gutterElement" style="height: 14px;">11</div><div class="cm-gutterElement" style="height: 14px;">12</div><div class="cm-gutterElement" style="height: 14px;">13</div><div class="cm-gutterElement" style="height: 14px;">14</div><div class="cm-gutterElement" style="height: 14px;">15</div><div class="cm-gutterElement" style="height: 14px;">16</div><div class="cm-gutterElement" style="height: 14px;">17</div><div class="cm-gutterElement" style="height: 14px;">18</div><div class="cm-gutterElement" style="height: 14px;">19</div><div class="cm-gutterElement" style="height: 14px;">20</div><div class="cm-gutterElement" style="height: 14px;">21</div><div class="cm-gutterElement" style="height: 14px;">22</div><div class="cm-gutterElement" style="height: 14px;">23</div><div class="cm-gutterElement" style="height: 14px;">24</div><div class="cm-gutterElement" style="height: 14px;">25</div><div class="cm-gutterElement" style="height: 14px;">26</div><div class="cm-gutterElement" style="height: 14px;">27</div><div class="cm-gutterElement" style="height: 14px;">28</div><div class="cm-gutterElement" style="height: 14px;">29</div><div class="cm-gutterElement" style="height: 14px;">30</div><div class="cm-gutterElement" style="height: 14px;">31</div><div class="cm-gutterElement" style="height: 14px;">32</div><div class="cm-gutterElement" style="height: 14px;">33</div><div class="cm-gutterElement" style="height: 14px;">34</div><div class="cm-gutterElement" style="height: 14px;">35</div><div class="cm-gutterElement" style="height: 14px;">36</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">Model Training - Per Camera with Camera-Specific Features</span></div><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><br></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">import</span> xgboost <span class="Í¼v">as</span> xgb</div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">def</span> <span class="Í¼y">train_models_per_camera</span><span class="Í¼1c">(</span>X_train<span class="Í¼1c">,</span> y_train<span class="Í¼1c">,</span> X_val<span class="Í¼1c">,</span> y_val<span class="Í¼1c">,</span> model_type<span class="Í¼13">=</span><span class="Í¼15">"enter"</span><span class="Í¼1c">)</span>:</div><div class="cm-line">    <span class="Í¼v">if</span> MODEL_TO_TRAIN <span class="Í¼13">==</span> <span class="Í¼15">'xgb'</span>:</div><div class="cm-line">        <span class="Í¼v">return</span> train_models_xgb_per_camera<span class="Í¼1c">(</span>X_train<span class="Í¼1c">,</span> y_train<span class="Í¼1c">,</span> X_val<span class="Í¼1c">,</span> y_val<span class="Í¼1c">,</span> model_type<span class="Í¼1c">)</span></div><div class="cm-line">    <span class="Í¼v">elif</span> MODEL_TO_TRAIN <span class="Í¼13">==</span> <span class="Í¼15">'et'</span>:</div><div class="cm-line">        <span class="Í¼v">return</span> train_models_et_per_camera<span class="Í¼1c">(</span>X_train<span class="Í¼1c">,</span> y_train<span class="Í¼1c">,</span> X_val<span class="Í¼1c">,</span> y_val<span class="Í¼1c">,</span> model_type<span class="Í¼1c">)</span></div><div class="cm-line">    <span class="Í¼v">else</span>:</div><div class="cm-line">        <span class="Í¼v">raise</span> ValueError<span class="Í¼1c">(</span><span class="Í¼16">f'Unknown model name </span><span class="Í¼17">{</span>model_name<span class="Í¼17">}</span><span class="Í¼16">'</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">def</span> <span class="Í¼y">train_models_xgb_per_camera</span><span class="Í¼1c">(</span>X_train<span class="Í¼1c">,</span> y_train<span class="Í¼1c">,</span> X_val<span class="Í¼1c">,</span> y_val<span class="Í¼1c">,</span> model_type<span class="Í¼13">=</span><span class="Í¼15">"enter"</span><span class="Í¼1c">)</span>:</div><div class="cm-line">    <span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">    Train models (GPU) for each forecast timestep</span></div><div class="cm-line"><span class="Í¼15">    Mirrors ExtraTrees philosophy: aggressive feature subsampling for generalization</span></div><div class="cm-line"><span class="Í¼15">    </span></div><div class="cm-line"><span class="Í¼15">    Args:</span></div><div class="cm-line"><span class="Í¼15">        X_train: (N, feature_dim) with camera features and ID</span></div><div class="cm-line"><span class="Í¼15">        y_train: (N, FORECAST_HORIZON) per-camera labels</span></div><div class="cm-line"><span class="Í¼15">        X_val: validation features</span></div><div class="cm-line"><span class="Í¼15">        y_val: validation labels</span></div><div class="cm-line"><span class="Í¼15">        model_type: "enter" or "exit"</span></div><div class="cm-line"><span class="Í¼15">    </span></div><div class="cm-line"><span class="Í¼15">    Returns:</span></div><div class="cm-line"><span class="Í¼15">        models: list of trained models (one per timestep)</span></div><div class="cm-line"><span class="Í¼15">        validation_scores: list of scores</span></div><div class="cm-line"><span class="Í¼15">    """</span></div><div class="cm-line">    models <span class="Í¼13">=</span> <span class="Í¼17">[</span><span class="Í¼17">]</span></div><div class="cm-line">    validation_scores <span class="Í¼13">=</span> <span class="Í¼17">[</span><span class="Í¼17">]</span></div><div class="cm-line">    printables <span class="Í¼13">=</span> <span class="Í¼17">[</span><span class="Í¼17">]</span></div><div class="cm-line">    </div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-gap" style="height: 3766px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.668px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>âœ… Model training functions loaded
</pre></div></div><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell" aria-label="Code Cell Content with Output" tabindex="-1" data-windowed-list-index="3" data-uuid="16073d74-b880-48cf-85c2-0ddcb214e0d1" id="16073d74-b880-48cf-85c2-0ddcb214e0d1" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[3]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 5036px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div><div class="cm-gutterElement" style="height: 14px;">6</div><div class="cm-gutterElement" style="height: 14px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 14px;">9</div><div class="cm-gutterElement" style="height: 14px;">10</div><div class="cm-gutterElement" style="height: 14px;">11</div><div class="cm-gutterElement" style="height: 14px;">12</div><div class="cm-gutterElement" style="height: 14px;">13</div><div class="cm-gutterElement" style="height: 14px;">14</div><div class="cm-gutterElement" style="height: 14px;">15</div><div class="cm-gutterElement" style="height: 14px;">16</div><div class="cm-gutterElement" style="height: 14px;">17</div><div class="cm-gutterElement" style="height: 14px;">18</div><div class="cm-gutterElement" style="height: 14px;">19</div><div class="cm-gutterElement" style="height: 14px;">20</div><div class="cm-gutterElement" style="height: 14px;">21</div><div class="cm-gutterElement" style="height: 14px;">22</div><div class="cm-gutterElement" style="height: 14px;">23</div><div class="cm-gutterElement" style="height: 14px;">24</div><div class="cm-gutterElement" style="height: 14px;">25</div><div class="cm-gutterElement" style="height: 14px;">26</div><div class="cm-gutterElement" style="height: 14px;">27</div><div class="cm-gutterElement" style="height: 14px;">28</div><div class="cm-gutterElement" style="height: 14px;">29</div><div class="cm-gutterElement" style="height: 14px;">30</div><div class="cm-gutterElement" style="height: 14px;">31</div><div class="cm-gutterElement" style="height: 14px;">32</div><div class="cm-gutterElement" style="height: 14px;">33</div><div class="cm-gutterElement" style="height: 14px;">34</div><div class="cm-gutterElement" style="height: 14px;">35</div><div class="cm-gutterElement" style="height: 14px;">36</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">Test Sequence Creation &amp; Submission Generation</span></div><div class="cm-line"><span class="Í¼15">With per-camera predictions and camera features</span></div><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">def</span> <span class="Í¼y">make_predictions</span><span class="Í¼1c">(</span>X_test_enter<span class="Í¼1c">,</span> X_test_exit<span class="Í¼1c">,</span> test_metadata<span class="Í¼1c">,</span> models_enter<span class="Í¼1c">,</span> models_exit<span class="Í¼1c">,</span> le<span class="Í¼1c">)</span>:</div><div class="cm-line">    <span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">    Generate predictions for all test sequences</span></div><div class="cm-line"><span class="Í¼15">    </span></div><div class="cm-line"><span class="Í¼15">    Args:</span></div><div class="cm-line"><span class="Í¼15">        X_test_enter: test features for enter</span></div><div class="cm-line"><span class="Í¼15">        X_test_exit: test features for exit</span></div><div class="cm-line"><span class="Í¼15">        test_metadata: sequence metadata</span></div><div class="cm-line"><span class="Í¼15">        models_enter, models_exit: trained models</span></div><div class="cm-line"><span class="Í¼15">        le: label encoder</span></div><div class="cm-line"><span class="Í¼15">    </span></div><div class="cm-line"><span class="Í¼15">    Returns:</span></div><div class="cm-line"><span class="Í¼15">        predictions: list of prediction dicts</span></div><div class="cm-line"><span class="Í¼15">    """</span></div><div class="cm-line">    predictions <span class="Í¼13">=</span> <span class="Í¼17">[</span><span class="Í¼17">]</span></div><div class="cm-line">    </div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"ðŸŽ¯ GENERATING PREDICTIONS"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    <span class="Í¼v">for</span> i <span class="Í¼v">in</span> tqdm<span class="Í¼1c">(</span><span class="cm-builtin">range</span><span class="Í¼1c">(</span><span class="cm-builtin">len</span><span class="Í¼1c">(</span>X_test_enter<span class="Í¼1c">)</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span> desc<span class="Í¼13">=</span><span class="Í¼15">"Predicting"</span><span class="Í¼1c">)</span>:</div><div class="cm-line">        X_single_enter <span class="Í¼13">=</span> X_test_enter<span class="Í¼17">[</span>i:i<span class="Í¼13">+</span><span class="Í¼x">1</span><span class="Í¼17">]</span></div><div class="cm-line">        X_single_exit <span class="Í¼13">=</span> X_test_exit<span class="Í¼17">[</span>i:i<span class="Í¼13">+</span><span class="Í¼x">1</span><span class="Í¼17">]</span></div><div class="cm-line">        metadata <span class="Í¼13">=</span> test_metadata<span class="Í¼17">[</span>i<span class="Í¼17">]</span></div><div class="cm-line">        </div><div class="cm-line">        enter_preds <span class="Í¼13">=</span> <span class="Í¼17">[</span><span class="Í¼17">]</span></div><div class="cm-line">        exit_preds <span class="Í¼13">=</span> <span class="Í¼17">[</span><span class="Í¼17">]</span></div><div class="cm-line">        </div><div class="cm-line">        <span class="Í¼14"># Predict each timestep</span></div><div class="cm-line">        <span class="Í¼v">for</span> t <span class="Í¼v">in</span> <span class="cm-builtin">range</span><span class="Í¼1c">(</span>FORECAST_HORIZON<span class="Í¼1c">)</span>:</div><div class="cm-line">            <span class="Í¼14"># Entry prediction</span></div><div class="cm-gap" style="height: 4508px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.666px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>âœ… Test &amp; submission functions loaded
</pre></div></div><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell" aria-label="Code Cell Content with Output" tabindex="-1" data-windowed-list-index="4" data-uuid="a01199d7-0b71-4a1a-b548-cc27074b6e2f" id="a01199d7-0b71-4a1a-b548-cc27074b6e2f" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[4]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 3454px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div><div class="cm-gutterElement" style="height: 14px;">6</div><div class="cm-gutterElement" style="height: 14px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 14px;">9</div><div class="cm-gutterElement" style="height: 14px;">10</div><div class="cm-gutterElement" style="height: 14px;">11</div><div class="cm-gutterElement" style="height: 14px;">12</div><div class="cm-gutterElement" style="height: 14px;">13</div><div class="cm-gutterElement" style="height: 14px;">14</div><div class="cm-gutterElement" style="height: 14px;">15</div><div class="cm-gutterElement" style="height: 14px;">16</div><div class="cm-gutterElement" style="height: 14px;">17</div><div class="cm-gutterElement" style="height: 14px;">18</div><div class="cm-gutterElement" style="height: 14px;">19</div><div class="cm-gutterElement" style="height: 14px;">20</div><div class="cm-gutterElement" style="height: 14px;">21</div><div class="cm-gutterElement" style="height: 14px;">22</div><div class="cm-gutterElement" style="height: 14px;">23</div><div class="cm-gutterElement" style="height: 14px;">24</div><div class="cm-gutterElement" style="height: 14px;">25</div><div class="cm-gutterElement" style="height: 14px;">26</div><div class="cm-gutterElement" style="height: 14px;">27</div><div class="cm-gutterElement" style="height: 14px;">28</div><div class="cm-gutterElement" style="height: 14px;">29</div><div class="cm-gutterElement" style="height: 14px;">30</div><div class="cm-gutterElement" style="height: 14px;">31</div><div class="cm-gutterElement" style="height: 14px;">32</div><div class="cm-gutterElement" style="height: 14px;">33</div><div class="cm-gutterElement" style="height: 14px;">34</div><div class="cm-gutterElement" style="height: 14px;">35</div><div class="cm-gutterElement" style="height: 14px;">36</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">Main Execution Pipeline</span></div><div class="cm-line"><span class="Í¼15">Orchestrates the complete workflow with multiple feature counts</span></div><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># best comb for now (2000, 2000)</span></div><div class="cm-line"><span class="Í¼v">def</span> <span class="Í¼y">run_complete_pipeline</span><span class="Í¼1c">(</span>feature_counts<span class="Í¼13">=</span><span class="Í¼17">[</span><span class="Í¼x">3000</span><span class="Í¼1c">,</span> <span class="Í¼x">2000</span><span class="Í¼1c">,</span> <span class="Í¼x">1000</span><span class="Í¼17">]</span><span class="Í¼1c">,</span></div><div class="cm-line">                                    camera_feature_count<span class="Í¼13">=</span><span class="Í¼x">2000</span><span class="Í¼1c">)</span>:</div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'#'</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"# STARTING PIPELINE"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"# Segment features: </span><span class="Í¼17">{</span>feature_counts<span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"# Camera features: </span><span class="Í¼17">{</span>camera_feature_count<span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'#'</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">\n"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    <span class="Í¼14"># =========================================================================</span></div><div class="cm-line">    <span class="Í¼14"># STEP 1: Load training features (FULL)</span></div><div class="cm-line">    <span class="Í¼14"># =========================================================================</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"STEP 1: LOADING TRAINING FEATURES"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    train_features<span class="Í¼1c">,</span> train_segment_ids<span class="Í¼1c">,</span> train_camera_features<span class="Í¼1c">,</span> _ <span class="Í¼13">=</span> load_full_train<span class="Í¼1c">(</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n  Loaded features:"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"    Segment features: </span><span class="Í¼17">{</span>train_features<span class="Í¼1c">.</span><span class="Í¼12">shape</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"    Segment IDs: </span><span class="Í¼17">{</span><span class="cm-builtin">len</span><span class="Í¼1c">(</span>train_segment_ids<span class="Í¼1c">)</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"STEP 2: FEATURE SELECTION ON SEGMENTS"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    max_features <span class="Í¼13">=</span> <span class="cm-builtin">max</span><span class="Í¼1c">(</span>feature_counts<span class="Í¼1c">)</span></div><div class="cm-line">    feature_importance_enter<span class="Í¼1c">,</span> feature_importance_exit<span class="Í¼1c">,</span> feature_importance <span class="Í¼13">=</span> \</div><div class="cm-line">        feature_selection_on_segments<span class="Í¼1c">(</span></div><div class="cm-line">            train_features<span class="Í¼1c">,</span></div><div class="cm-line">            train_segment_ids<span class="Í¼1c">,</span></div><div class="cm-gap" style="height: 2926px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.666px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>
################################################################################
# STARTING PIPELINE
# Segment features: [2000]
# Camera features: 2000
################################################################################


================================================================================
STEP 1: LOADING TRAINING FEATURES
================================================================================

  Loaded features:
    Segment features: (1971, 295244)
    Segment IDs: 1971

================================================================================
STEP 2: FEATURE SELECTION ON SEGMENTS
================================================================================

================================================================================
ðŸŽ¯ FEATURE SELECTION ON SEGMENTS
================================================================================
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                              
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>  Total segments: 1971
  Subset size: 1971 (100%)
  Feature dimension: 295244
  Target features: 2000

  Training Entry model on 1971 segments...
  Training Exit model on 1971 segments...

  ============================================================================
  ðŸ“Š OVERLAP ANALYSIS
  ============================================================================
  Top 2000 Entry features: 2000
  Top 2000 Exit features:  2000
  
  ðŸ”— OVERLAP: 53 features (2.6%)
     â†’ Features important for BOTH tasks
  
  ðŸŸ¢ ENTRY-ONLY: 1947 features (97.4%)
     â†’ Features only important for entrance
  
  ðŸ”´ EXIT-ONLY: 1947 features (97.4%)
     â†’ Features only important for exit
  
  ============================================================================
  ðŸŽ¯ WEIGHTED METHOD (0.4 entry + 0.6 exit) SELECTED:
  ============================================================================
  From overlap:        53 / 2000 (2.6%)
  From entry-only:    145 / 2000 (7.2%)
  From exit-only:    1794 / 2000 (89.7%)
  
  In top-2000 entry:   198 / 2000 (9.9%)
  In top-2000 exit:   1847 / 2000 (92.3%)
  ============================================================================

  ðŸ“ˆ Feature importance correlation: 0.112
     â†’ Tasks are WEAKLY CORRELATED (union method might help)

  ðŸ”€ UNION METHOD would give: 3947 features
     â†’ 1947 more than target (97.4% increase)

  âœ… SELECTION COMPLETE:
     Entry-specific: 2000 features
     Exit-specific:  2000 features
     Weighted (old): 2000 features

  Top 10 Entry features:   [1907, 173625, 29648, 152637, 30341, 184484, 224048, 295243, 3189, 148288]
  Top 10 Exit features:    [1907, 1946, 158823, 152325, 177576, 148288, 155989, 153390, 224048, 81313]
  Top 10 Weighted features: [1907, 173625, 224048, 148288, 152325, 152637, 1946, 153390, 3189, 4076]

================================================================================
ðŸŽ¯ CAMERA FEATURE SELECTION (TASK-SPECIFIC)
================================================================================
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                                 
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>  Total camera samples: 7884
  Subset size: 1576 (20%)
  Feature dimension: 36905
  Target features: 2000

  Training Entry model on 1576 camera samples...
  Training Exit model on 1576 camera samples...

  ============================================================================
  ðŸ“Š CAMERA FEATURE OVERLAP ANALYSIS
  ============================================================================
  Top 2000 Entry features: 2000
  Top 2000 Exit features:  2000
  
  ðŸ”— OVERLAP: 159 features (8.0%)
  ðŸŸ¢ ENTRY-ONLY: 1841 features (92.0%)
  ðŸ”´ EXIT-ONLY: 1841 features (92.0%)
  
  ============================================================================
  ðŸŽ¯ WEIGHTED METHOD SELECTED:
  ============================================================================
  From overlap:       159 / 2000 (8.0%)
  From entry-only:    119 / 2000 (5.9%)
  From exit-only:    1675 / 2000 (83.8%)
  
  In top-2000 entry:   278 / 2000 (13.9%)
  In top-2000 exit:   1834 / 2000 (91.7%)
  ============================================================================

  ðŸ“ˆ Camera feature importance correlation: 0.063
     â†’ Tasks are WEAKLY CORRELATED (union method might help)

  ðŸ”€ UNION METHOD would give: 3841 features
     â†’ 1841 more than target (92.1% increase)

  âœ… CAMERA SELECTION COMPLETE:
     Entry-specific: 2000 features
     Exit-specific:  2000 features
     Weighted (old): 2000 features

================================================================================
STEP 4: TRAINING WITH DIFFERENT FEATURE COUNTS
================================================================================

################################################################################
# PROCESSING 2000 SEGMENT + 2000 CAMERA FEATURES
################################################################################

  Applying feature selection to segments...
    Train segments enter: (1971, 2000)
    Train segments exit: (1971, 2000)

  Creating training sequences from reduced segments...

================================================================================
ðŸŽ¬ CREATING FORECASTING SEQUENCES (TEMPORAL STATS)
================================================================================
  Lookback: 15 segments
  Embargo: 2 segments
  Forecast: 5 segments
  Cameras: 4
  Entry segment feature dim: 2000
  Exit segment feature dim: 2000
  Camera feature dim: 2000
  ðŸ”¥ TEMPORAL COMPRESSION ENABLED (9 stats per feature)
  Batch size: 400
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                       
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    âœ… Norman Niles #1: 1502 sequences
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                       
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    âœ… Norman Niles #2: 1502 sequences
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                       
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    âœ… Norman Niles #3: 1502 sequences
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                       
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    âœ… Norman Niles #4: 1502 sequences

  ðŸ“Š Total sequences created: 6008
  Converting 16 batches to final arrays...
  Entry feature dimension: 36004
  Exit feature dimension: 36004
  ðŸŽ‰ COMPRESSION: 60004 â†’ 36004 features
     Reduction: 40.0%
  Entry memory: 0.87 GB
  Exit memory: 0.87 GB

  Created sequences: enter (6008, 36004) | exit (6008, 36004) 
  Memory usage: 1.73 GB

================================================================================
ðŸ”€ INTERLEAVED TRAIN/VAL SPLIT
================================================================================
  Train=5408, Val=600 (every 10th seq)

  Train shape: (5408, 36004) * 2
  Val shape: (600, 36004) * 2

================================================================================
ðŸŽ“ TRAINING ENTER MODELS (XGB-GPU)
================================================================================
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>Training enter: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [06:01&lt;00:00, 72.38s/it]
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>   T+3: F1=0.5433, Acc=0.5667, Score=0.5503
   T+4: F1=0.5367, Acc=0.5650, Score=0.5452
   T+5: F1=0.5232, Acc=0.5617, Score=0.5347
   T+6: F1=0.5826, Acc=0.6083, Score=0.5903
   T+7: F1=0.5042, Acc=0.5400, Score=0.5149

  ðŸ“Š Average Score: 0.5471

================================================================================
ðŸŽ“ TRAINING EXIT MODELS (XGB-GPU)
================================================================================
  ðŸŽ¯ Exit class imbalance detected: scale_pos_weight=9.42
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>Training exit: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [04:59&lt;00:00, 59.85s/it]
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>   T+3: F1=0.4835, Acc=0.9417, Score=0.6209
   T+4: F1=0.3486, Acc=0.9017, Score=0.5145
   T+5: F1=0.4178, Acc=0.9200, Score=0.5685
   T+6: F1=0.4798, Acc=0.9167, Score=0.6109
   T+7: F1=0.3752, Acc=0.9133, Score=0.5366

  ðŸ“Š Average Score: 0.5703

================================================================================
ðŸ† TRAINING COMPLETE
================================================================================
  Entrance avg score: 0.5471
  Exit avg score: 0.5703
  Overall avg score: 0.5587

================================================================================
PROCESSING TEST DATA
================================================================================
    Test segments: (660, 2000)
  Creating test sequences from reduced segments...

================================================================================
ðŸŽ¬ CREATING TEST SEQUENCES (TEMPORAL STATS)
================================================================================
  Lookback: 15 segments
  Cameras: 4
  Entry segment feature dim: 2000
  Exit segment feature dim: 2000
  Camera feature dim (reduced): 2000
  ðŸ”¥ TEMPORAL COMPRESSION ENABLED (9 stats per feature)
  Batch size: 400
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                      
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    âœ… Norman Niles #1: 44 sequences
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                      
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    âœ… Norman Niles #2: 44 sequences
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                      
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    âœ… Norman Niles #3: 44 sequences
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                      
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    âœ… Norman Niles #4: 44 sequences

  ðŸ“Š Total test sequences: 176
  Converting 1 batches to final arrays...
  Entry feature dimension: 36004
  Exit feature dimension: 36004
  Entry memory: 0.03 GB
  Exit memory: 0.03 GB

================================================================================
ðŸŽ¯ GENERATING PREDICTIONS
================================================================================
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>Predicting: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 176/176 [00:04&lt;00:00, 41.36it/s]
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>  âœ… Generated predictions for 176 sequences

================================================================================
ðŸ“ CREATING SUBMISSION
================================================================================
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>                                                                          
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>  Filled predictions: 1760/1760 (100.0%)

  ðŸ“ˆ PREDICTION DISTRIBUTION:
    free flowing        :  1521 ( 86.4%)
    moderate delay      :   123 (  7.0%)
    heavy delay         :    96 (  5.5%)
    light delay         :    20 (  1.1%)

  ðŸ’¾ Saved to: ./submissions/submission_20251130_064131_2000feat.csv
ðŸ” Checking uniqueness of submission_20251130_064131_2000feat.csv...
âœ… UNIQUE - Different from all 60 existing submission(s)
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html"><a href="https://kkb-production.jupyter-proxy.kaggle.net/files/submissions/submission_20251130_064131_2000feat.csv" target="_blank" rel="noopener">./submissions/submission_20251130_064131_2000feat.csv</a><br></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>
  ðŸ§¹ Cleaning up memory...

================================================================================
âœ… COMPLETED 2000 FEATURES
================================================================================


================================================================================
FINAL CLEANUP
================================================================================

################################################################################
# PIPELINE COMPLETE!
################################################################################

ðŸ“Š RESULTS SUMMARY:
   2000 features â†’ ./submissions/submission_20251130_064131_2000feat.csv

âœ… All done!
</pre></div></div><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" aria-label="Code Cell Content" tabindex="-1" data-windowed-list-index="5" data-uuid="5158eb12-1e02-4d6f-a25a-d83140d8c2ba" id="5158eb12-1e02-4d6f-a25a-d83140d8c2ba" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[ ]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 94px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">9</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼v">import</span> numpy <span class="Í¼v">as</span> np</div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># x = np.ones((100_000, 100_000), dtype=np.float64)</span></div><div class="cm-line"><span class="Í¼14"># x.sum()</span></div><div class="cm-line"><br></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.6641px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell" aria-label="Code Cell Content with Output" tabindex="-1" data-windowed-list-index="6" data-uuid="e9ea8c48-49d2-4022-9ebe-3c30a1d0aac7" id="e9ea8c48-49d2-4022-9ebe-3c30a1d0aac7" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[1]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 66px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">9</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼v">from</span> IPython<span class="Í¼1c">.</span>display <span class="Í¼v">import</span> FileLink</div><div class="cm-line"><br></div><div class="cm-line">FileLink<span class="Í¼1c">(</span><span class="Í¼15">'./submissions/submission_20251130_064131_2000feat.csv'</span><span class="Í¼1c">)</span></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.668px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="lm-Widget lm-Panel jp-OutputArea-child jp-OutputArea-executeResult"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt">[1]:</div><div class="lm-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html"><a href="https://kkb-production.jupyter-proxy.kaggle.net/files/submissions/submission_20251130_064131_2000feat.csv" target="_blank" rel="noopener">./submissions/submission_20251130_064131_2000feat.csv</a><br></div></div><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell" aria-label="Code Cell Content with Output" tabindex="-1" data-windowed-list-index="7" data-uuid="edd993a4-56f4-48d5-b90b-59afc10c41dd" id="edd993a4-56f4-48d5-b90b-59afc10c41dd" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[4]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 9040px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div><div class="cm-gutterElement" style="height: 14px;">6</div><div class="cm-gutterElement" style="height: 14px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 14px;">9</div><div class="cm-gutterElement" style="height: 14px;">10</div><div class="cm-gutterElement" style="height: 14px;">11</div><div class="cm-gutterElement" style="height: 14px;">12</div><div class="cm-gutterElement" style="height: 14px;">13</div><div class="cm-gutterElement" style="height: 14px;">14</div><div class="cm-gutterElement" style="height: 14px;">15</div><div class="cm-gutterElement" style="height: 14px;">16</div><div class="cm-gutterElement" style="height: 14px;">17</div><div class="cm-gutterElement" style="height: 14px;">18</div><div class="cm-gutterElement" style="height: 14px;">19</div><div class="cm-gutterElement" style="height: 14px;">20</div><div class="cm-gutterElement" style="height: 14px;">21</div><div class="cm-gutterElement" style="height: 14px;">22</div><div class="cm-gutterElement" style="height: 14px;">23</div><div class="cm-gutterElement" style="height: 14px;">24</div><div class="cm-gutterElement" style="height: 14px;">25</div><div class="cm-gutterElement" style="height: 14px;">26</div><div class="cm-gutterElement" style="height: 14px;">27</div><div class="cm-gutterElement" style="height: 14px;">28</div><div class="cm-gutterElement" style="height: 14px;">29</div><div class="cm-gutterElement" style="height: 14px;">30</div><div class="cm-gutterElement" style="height: 14px;">31</div><div class="cm-gutterElement" style="height: 14px;">32</div><div class="cm-gutterElement" style="height: 14px;">33</div><div class="cm-gutterElement" style="height: 14px;">34</div><div class="cm-gutterElement" style="height: 14px;">35</div><div class="cm-gutterElement" style="height: 14px;">36</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼14"># MD:</span></div><div class="cm-line"><span class="Í¼14">#: ðŸš€ Barbados Traffic Forecasting - Per-Camera Specialized Models</span></div><div class="cm-line"><span class="Í¼14">#: ==========================================</span></div><div class="cm-line"><span class="Í¼14">#: Architecture: 40 specialized models (5 timesteps Ã— 2 tasks Ã— 4 cameras)</span></div><div class="cm-line"><span class="Í¼14">#: - Each model trained on camera-specific features</span></div><div class="cm-line"><span class="Í¼14">#: - Separate feature selection for each (timestep, task, camera) combination</span></div><div class="cm-line"><span class="Í¼14">#: - Temporal statistics compression enabled by default</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># CODE:</span></div><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">Configuration and Imports</span></div><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼v">import</span> warnings</div><div class="cm-line">warnings<span class="Í¼1c">.</span><span class="Í¼12">filterwarnings</span><span class="Í¼1c">(</span><span class="Í¼15">'ignore'</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">import</span> os</div><div class="cm-line"><span class="Í¼v">import</span> pickle</div><div class="cm-line"><span class="Í¼v">import</span> numpy <span class="Í¼v">as</span> np</div><div class="cm-line"><span class="Í¼v">import</span> pandas <span class="Í¼v">as</span> pd</div><div class="cm-line"><span class="Í¼v">from</span> sklearn<span class="Í¼1c">.</span>ensemble <span class="Í¼v">import</span> ExtraTreesClassifier</div><div class="cm-line"><span class="Í¼v">from</span> sklearn<span class="Í¼1c">.</span>preprocessing <span class="Í¼v">import</span> LabelEncoder</div><div class="cm-line"><span class="Í¼v">from</span> sklearn<span class="Í¼1c">.</span>metrics <span class="Í¼v">import</span> f1_score<span class="Í¼1c">,</span> accuracy_score</div><div class="cm-line"><span class="Í¼v">import</span> gc</div><div class="cm-line"><span class="Í¼v">from</span> tqdm <span class="Í¼v">import</span> tqdm</div><div class="cm-line"><span class="Í¼v">from</span> IPython<span class="Í¼1c">.</span>display <span class="Í¼v">import</span> FileLink</div><div class="cm-line"><span class="Í¼v">import</span> xgboost <span class="Í¼v">as</span> xgb</div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># ============================================================================</span></div><div class="cm-line"><span class="Í¼14"># CONFIGURATION</span></div><div class="cm-line"><span class="Í¼14"># ============================================================================</span></div><div class="cm-line"><span class="Í¼14"># Feature Selection</span></div><div class="cm-line">NUM_SEGMENT_FEATURES <span class="Í¼13">=</span> <span class="Í¼x">2000</span>      <span class="Í¼14"># Top K segment features per (timestep, task)</span></div><div class="cm-line">NUM_CAMERA_FEATURES <span class="Í¼13">=</span> <span class="Í¼x">2000</span>      <span class="Í¼14"># Top K camera features per (timestep, task, camera)</span></div><div class="cm-line">FEATURE_SELECTION_SAMPLE_RATIO <span class="Í¼13">=</span> <span class="Í¼x">0.25</span>  <span class="Í¼14"># Sample 20% of data for feature selection</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Model Training</span></div><div class="cm-gap" style="height: 8512px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.6641px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>âœ… Train dataframe: (16076, 14)
âœ… Test input dataframe: (2640, 14)
âœ… Sample submission: (1760, 3)

================================================================================
ðŸ“Š CONFIGURATION
================================================================================
  Segment features per (timestep, task): 2000
  Camera features per (timestep, task, camera): 2000
  Feature selection sample ratio: 0.25
  Split method: interleaved
  Model type: et
  Temporal compression: False
  Total models to train: 40 (5 timesteps Ã— 2 tasks Ã— 4 cameras)

âœ… Loaded
</pre></div></div><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" aria-label="Code Cell Content" tabindex="-1" data-windowed-list-index="8" data-uuid="2a02f23c-f4f8-409e-957f-66515af0ae90" id="2a02f23c-f4f8-409e-957f-66515af0ae90" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[ ]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 3986px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div><div class="cm-gutterElement" style="height: 14px;">6</div><div class="cm-gutterElement" style="height: 14px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 14px;">9</div><div class="cm-gutterElement" style="height: 14px;">10</div><div class="cm-gutterElement" style="height: 14px;">11</div><div class="cm-gutterElement" style="height: 14px;">12</div><div class="cm-gutterElement" style="height: 14px;">13</div><div class="cm-gutterElement" style="height: 14px;">14</div><div class="cm-gutterElement" style="height: 14px;">15</div><div class="cm-gutterElement" style="height: 14px;">16</div><div class="cm-gutterElement" style="height: 14px;">17</div><div class="cm-gutterElement" style="height: 14px;">18</div><div class="cm-gutterElement" style="height: 14px;">19</div><div class="cm-gutterElement" style="height: 14px;">20</div><div class="cm-gutterElement" style="height: 14px;">21</div><div class="cm-gutterElement" style="height: 14px;">22</div><div class="cm-gutterElement" style="height: 14px;">23</div><div class="cm-gutterElement" style="height: 14px;">24</div><div class="cm-gutterElement" style="height: 14px;">25</div><div class="cm-gutterElement" style="height: 14px;">26</div><div class="cm-gutterElement" style="height: 14px;">27</div><div class="cm-gutterElement" style="height: 14px;">28</div><div class="cm-gutterElement" style="height: 14px;">29</div><div class="cm-gutterElement" style="height: 14px;">30</div><div class="cm-gutterElement" style="height: 14px;">31</div><div class="cm-gutterElement" style="height: 14px;">32</div><div class="cm-gutterElement" style="height: 14px;">33</div><div class="cm-gutterElement" style="height: 14px;">34</div><div class="cm-gutterElement" style="height: 14px;">35</div><div class="cm-gutterElement" style="height: 14px;">36</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">Main pipeline: 40 specialized models (5 timesteps Ã— 2 tasks Ã— 4 cameras)</span></div><div class="cm-line"><span class="Í¼15">"""</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'#'</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"# STARTING SPECIALIZED PIPELINE"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"# Total models: </span><span class="Í¼17">{</span>FORECAST_HORIZON <span class="Í¼13">*</span> <span class="Í¼x">2</span> <span class="Í¼13">*</span> <span class="Í¼x">4</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'#'</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">\n"</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># =========================================================================</span></div><div class="cm-line"><span class="Í¼14"># STEP 1: Load features</span></div><div class="cm-line"><span class="Í¼14"># =========================================================================</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"STEP 1: LOADING FEATURES"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line">train_features<span class="Í¼1c">,</span> train_segment_ids<span class="Í¼1c">,</span> train_camera_features<span class="Í¼1c">,</span> _ <span class="Í¼13">=</span> load_full_train<span class="Í¼1c">(</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"  Train segments: </span><span class="Í¼17">{</span>train_features<span class="Í¼1c">.</span><span class="Í¼12">shape</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"  Train segment IDs: </span><span class="Í¼17">{</span><span class="cm-builtin">len</span><span class="Í¼1c">(</span>train_segment_ids<span class="Í¼1c">)</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">with</span> <span class="cm-builtin">open</span><span class="Í¼1c">(</span>TEST_FEATURES_FILE<span class="Í¼1c">,</span> <span class="Í¼15">'rb'</span><span class="Í¼1c">)</span> <span class="Í¼v">as</span> f:</div><div class="cm-line">    test_data <span class="Í¼13">=</span> pickle<span class="Í¼1c">.</span><span class="Í¼12">load</span><span class="Í¼1c">(</span>f<span class="Í¼1c">)</span></div><div class="cm-line">test_features <span class="Í¼13">=</span> test_data<span class="Í¼17">[</span><span class="Í¼15">'features'</span><span class="Í¼17">]</span></div><div class="cm-line">test_segment_ids <span class="Í¼13">=</span> test_data<span class="Í¼17">[</span><span class="Í¼15">'segment_ids'</span><span class="Í¼17">]</span></div><div class="cm-line">test_camera_features <span class="Í¼13">=</span> test_data<span class="Í¼17">[</span><span class="Í¼15">'camera_features'</span><span class="Í¼17">]</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"  Test segments: </span><span class="Í¼17">{</span>test_features<span class="Í¼1c">.</span><span class="Í¼12">shape</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># =========================================================================</span></div><div class="cm-line"><span class="Í¼14"># STEP 2: Feature selection and model training - nested loops</span></div><div class="cm-line"><span class="Í¼14"># =========================================================================</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"STEP 2: FEATURE SELECTION &amp; TRAINING"</span><span class="Í¼1c">)</span></div><div class="cm-line"><span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Storage for models and selected features</span></div><div class="cm-line">models <span class="Í¼13">=</span> <span class="Í¼17">{</span><span class="Í¼17">}</span>  <span class="Í¼14"># models[camera][timestep][task] = model</span></div><div class="cm-line">segment_features_selected <span class="Í¼13">=</span> <span class="Í¼17">{</span><span class="Í¼17">}</span>  <span class="Í¼14"># [timestep][task] = indices</span></div><div class="cm-gap" style="height: 3458px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.6641px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" aria-label="Code Cell Content" tabindex="-1" data-windowed-list-index="9" data-uuid="9e81346a-89c4-4f89-92f2-ae804d0b89aa" id="9e81346a-89c4-4f89-92f2-ae804d0b89aa" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[ ]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 2978px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div><div class="cm-gutterElement" style="height: 14px;">6</div><div class="cm-gutterElement" style="height: 14px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 14px;">9</div><div class="cm-gutterElement" style="height: 14px;">10</div><div class="cm-gutterElement" style="height: 14px;">11</div><div class="cm-gutterElement" style="height: 14px;">12</div><div class="cm-gutterElement" style="height: 14px;">13</div><div class="cm-gutterElement" style="height: 14px;">14</div><div class="cm-gutterElement" style="height: 14px;">15</div><div class="cm-gutterElement" style="height: 14px;">16</div><div class="cm-gutterElement" style="height: 14px;">17</div><div class="cm-gutterElement" style="height: 14px;">18</div><div class="cm-gutterElement" style="height: 14px;">19</div><div class="cm-gutterElement" style="height: 14px;">20</div><div class="cm-gutterElement" style="height: 14px;">21</div><div class="cm-gutterElement" style="height: 14px;">22</div><div class="cm-gutterElement" style="height: 14px;">23</div><div class="cm-gutterElement" style="height: 14px;">24</div><div class="cm-gutterElement" style="height: 14px;">25</div><div class="cm-gutterElement" style="height: 14px;">26</div><div class="cm-gutterElement" style="height: 14px;">27</div><div class="cm-gutterElement" style="height: 14px;">28</div><div class="cm-gutterElement" style="height: 14px;">29</div><div class="cm-gutterElement" style="height: 14px;">30</div><div class="cm-gutterElement" style="height: 14px;">31</div><div class="cm-gutterElement" style="height: 14px;">32</div><div class="cm-gutterElement" style="height: 14px;">33</div><div class="cm-gutterElement" style="height: 14px;">34</div><div class="cm-gutterElement" style="height: 14px;">35</div><div class="cm-gutterElement" style="height: 14px;">36</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼14"># MD:</span></div><div class="cm-line"><span class="Í¼14">#: CELL 1: Feature Selection &amp; Sequence Creation (Run Once)</span></div><div class="cm-line"><span class="Í¼14">#: ============================================</span></div><div class="cm-line"><span class="Í¼14">#: This cell performs feature selection and creates all sequences</span></div><div class="cm-line"><span class="Í¼14">#: Results are saved to disk for reuse with different model parameters</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># CODE:</span></div><div class="cm-line"><span class="Í¼v">def</span> <span class="Í¼y">save_selected_features_and_sequences</span><span class="Í¼1c">(</span><span class="Í¼1c">)</span>:</div><div class="cm-line">    <span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">    Perform feature selection once and save results + sequences to disk</span></div><div class="cm-line"><span class="Í¼15">    This allows training different models without repeating feature selection</span></div><div class="cm-line"><span class="Í¼15">    """</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'#'</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"# FEATURE SELECTION &amp; SEQUENCE CREATION"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"# Segment features: </span><span class="Í¼17">{</span>NUM_SEGMENT_FEATURES<span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"# Camera features: </span><span class="Í¼17">{</span>NUM_CAMERA_FEATURES<span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'#'</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">\n"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    <span class="Í¼14"># =========================================================================</span></div><div class="cm-line">    <span class="Í¼14"># STEP 1: Load features</span></div><div class="cm-line">    <span class="Í¼14"># =========================================================================</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"\n</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"STEP 1: LOADING FEATURES"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"</span><span class="Í¼17">{</span><span class="Í¼15">'='</span><span class="Í¼13">*</span><span class="Í¼x">80</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    train_features<span class="Í¼1c">,</span> train_segment_ids<span class="Í¼1c">,</span> train_camera_features<span class="Í¼1c">,</span> _ <span class="Í¼13">=</span> load_full_train<span class="Í¼1c">(</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"  Train segments: </span><span class="Í¼17">{</span>train_features<span class="Í¼1c">.</span><span class="Í¼12">shape</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"  Train segment IDs: </span><span class="Í¼17">{</span><span class="cm-builtin">len</span><span class="Í¼1c">(</span>train_segment_ids<span class="Í¼1c">)</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-line">    <span class="Í¼v">with</span> <span class="cm-builtin">open</span><span class="Í¼1c">(</span>TEST_FEATURES_FILE<span class="Í¼1c">,</span> <span class="Í¼15">'rb'</span><span class="Í¼1c">)</span> <span class="Í¼v">as</span> f:</div><div class="cm-line">        test_data <span class="Í¼13">=</span> pickle<span class="Í¼1c">.</span><span class="Í¼12">load</span><span class="Í¼1c">(</span>f<span class="Í¼1c">)</span></div><div class="cm-line">    test_features <span class="Í¼13">=</span> test_data<span class="Í¼17">[</span><span class="Í¼15">'features'</span><span class="Í¼17">]</span></div><div class="cm-line">    test_segment_ids <span class="Í¼13">=</span> test_data<span class="Í¼17">[</span><span class="Í¼15">'segment_ids'</span><span class="Í¼17">]</span></div><div class="cm-line">    test_camera_features <span class="Í¼13">=</span> test_data<span class="Í¼17">[</span><span class="Í¼15">'camera_features'</span><span class="Í¼17">]</span></div><div class="cm-line">    <span class="cm-builtin">print</span><span class="Í¼1c">(</span><span class="Í¼16">f"  Test segments: </span><span class="Í¼17">{</span>test_features<span class="Í¼1c">.</span><span class="Í¼12">shape</span><span class="Í¼17">}</span><span class="Í¼16">"</span><span class="Í¼1c">)</span></div><div class="cm-line">    </div><div class="cm-gap" style="height: 2450px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.6641px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell" aria-label="Code Cell Content with Output" tabindex="-1" data-windowed-list-index="10" data-uuid="b7e50842-201b-475c-9e64-56bac3bacb49" id="b7e50842-201b-475c-9e64-56bac3bacb49" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[7]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 4896px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div><div class="cm-gutterElement" style="height: 14px;">6</div><div class="cm-gutterElement" style="height: 14px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 14px;">9</div><div class="cm-gutterElement" style="height: 14px;">10</div><div class="cm-gutterElement" style="height: 14px;">11</div><div class="cm-gutterElement" style="height: 14px;">12</div><div class="cm-gutterElement" style="height: 14px;">13</div><div class="cm-gutterElement" style="height: 14px;">14</div><div class="cm-gutterElement" style="height: 14px;">15</div><div class="cm-gutterElement" style="height: 14px;">16</div><div class="cm-gutterElement" style="height: 14px;">17</div><div class="cm-gutterElement" style="height: 14px;">18</div><div class="cm-gutterElement" style="height: 14px;">19</div><div class="cm-gutterElement" style="height: 14px;">20</div><div class="cm-gutterElement" style="height: 14px;">21</div><div class="cm-gutterElement" style="height: 14px;">22</div><div class="cm-gutterElement" style="height: 14px;">23</div><div class="cm-gutterElement" style="height: 14px;">24</div><div class="cm-gutterElement" style="height: 14px;">25</div><div class="cm-gutterElement" style="height: 14px;">26</div><div class="cm-gutterElement" style="height: 14px;">27</div><div class="cm-gutterElement" style="height: 14px;">28</div><div class="cm-gutterElement" style="height: 14px;">29</div><div class="cm-gutterElement" style="height: 14px;">30</div><div class="cm-gutterElement" style="height: 14px;">31</div><div class="cm-gutterElement" style="height: 14px;">32</div><div class="cm-gutterElement" style="height: 14px;">33</div><div class="cm-gutterElement" style="height: 14px;">34</div><div class="cm-gutterElement" style="height: 14px;">35</div><div class="cm-gutterElement" style="height: 14px;">36</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># MD:</span></div><div class="cm-line"><span class="Í¼14">#: CELL 2: Load Sequences &amp; Train Models</span></div><div class="cm-line"><span class="Í¼14">#: ============================================</span></div><div class="cm-line"><span class="Í¼14">#: This cell loads pre-computed sequences and trains models</span></div><div class="cm-line"><span class="Í¼14">#: Can be run multiple times with different model parameters</span></div><div class="cm-line"><br></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Model Training</span></div><div class="cm-line">SPLIT_METHOD <span class="Í¼13">=</span> <span class="Í¼15">'time_based'</span>     <span class="Í¼14"># 'time_based' or 'interleaved'</span></div><div class="cm-line">MODEL_TO_TRAIN <span class="Í¼13">=</span> <span class="Í¼15">'et'</span>          <span class="Í¼14"># 'xgb' or 'et'</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">def</span> <span class="Í¼y">train_single_specialized_model_xgb</span><span class="Í¼1c">(</span>X_train<span class="Í¼1c">,</span> y_train<span class="Í¼1c">,</span> X_val<span class="Í¼1c">,</span> y_val<span class="Í¼1c">,</span> </div><div class="cm-line">                                       camera_name<span class="Í¼1c">,</span> timestep<span class="Í¼1c">,</span> task<span class="Í¼1c">)</span>:</div><div class="cm-line">    <span class="Í¼15">"""</span></div><div class="cm-line"><span class="Í¼15">    Train ONE specialized XGBoost model</span></div><div class="cm-line"><span class="Í¼15">    </span></div><div class="cm-line"><span class="Í¼15">    Args:</span></div><div class="cm-line"><span class="Í¼15">        X_train, y_train: training data</span></div><div class="cm-line"><span class="Í¼15">        X_val, y_val: validation data</span></div><div class="cm-line"><span class="Í¼15">        camera_name: camera identifier</span></div><div class="cm-line"><span class="Í¼15">        timestep: 0-4</span></div><div class="cm-line"><span class="Í¼15">        task: 'enter' or 'exit'</span></div><div class="cm-line"><span class="Í¼15">    </span></div><div class="cm-line"><span class="Í¼15">    Returns:</span></div><div class="cm-line"><span class="Í¼15">        model: trained model</span></div><div class="cm-line"><span class="Í¼15">        score: validation score</span></div><div class="cm-line"><span class="Í¼15">    """</span></div><div class="cm-line">    <span class="Í¼14"># Adjust params based on reduced feature count</span></div><div class="cm-line">    params <span class="Í¼13">=</span> <span class="Í¼17">{</span></div><div class="cm-line">        <span class="Í¼15">'n_estimators'</span>: <span class="Í¼x">250</span><span class="Í¼1c">,</span>  <span class="Í¼14"># Slightly reduced</span></div><div class="cm-line">        <span class="Í¼15">'learning_rate'</span>: <span class="Í¼x">0.05</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'max_depth'</span>: <span class="Í¼x">6</span><span class="Í¼1c">,</span>  <span class="Í¼14"># Shallower</span></div><div class="cm-line">        <span class="Í¼15">'colsample_bytree'</span>: <span class="Í¼x">0.05</span><span class="Í¼1c">,</span>  <span class="Í¼14"># More features per tree (2000*0.05 = 100)</span></div><div class="cm-line">        <span class="Í¼15">'subsample'</span>: <span class="Í¼x">0.85</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'objective'</span>: <span class="Í¼15">'multi:softprob'</span><span class="Í¼1c">,</span></div><div class="cm-gap" style="height: 4368px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.668px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>
################################################################################
# TRAINING FROM SAVED SEQUENCES
# Model type: et
# Split method: time_based
################################################################################

Loading from: /kaggle/working/sequences

Configuration:
  Segment features: 2000
  Camera features: 2000
  Temporal stats: False

================================================================================
TRAINING MODELS
================================================================================
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>ðŸš€ Total Progress:   0%|          | 0/40 [00:00&lt;?, ?it/s]</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>
ðŸŽ¯ Training: T+3
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>ðŸš€ Total Progress:  20%|â–ˆâ–ˆ        | 8/40 [01:04&lt;02:58,  5.57s/it]</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    T+3 | ENTER | Norman Niles #1 Score: 0.2420
    T+3 | ENTER | Norman Niles #2 Score: 0.2345
    T+3 | ENTER | Norman Niles #3 Score: 0.2742
    T+3 | ENTER | Norman Niles #4 Score: 0.2158
    T+3 | EXIT  | Norman Niles #1 Score: 0.4579
    T+3 | EXIT  | Norman Niles #2 Score: 0.4480
    T+3 | EXIT  | Norman Niles #3 Score: 0.4305
    T+3 | EXIT  | Norman Niles #4 Score: 0.4192

ðŸŽ¯ Training: T+4
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>ðŸš€ Total Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 16/40 [02:07&lt;02:14,  5.62s/it]</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    T+4 | ENTER | Norman Niles #1 Score: 0.2464
    T+4 | ENTER | Norman Niles #2 Score: 0.2335
    T+4 | ENTER | Norman Niles #3 Score: 0.2121
    T+4 | ENTER | Norman Niles #4 Score: 0.2613
    T+4 | EXIT  | Norman Niles #1 Score: 0.4579
    T+4 | EXIT  | Norman Niles #2 Score: 0.4480
    T+4 | EXIT  | Norman Niles #3 Score: 0.4305
    T+4 | EXIT  | Norman Niles #4 Score: 0.4192

ðŸŽ¯ Training: T+5
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>ðŸš€ Total Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 24/40 [03:15&lt;01:39,  6.21s/it]</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    T+5 | ENTER | Norman Niles #1 Score: 0.2493
    T+5 | ENTER | Norman Niles #2 Score: 0.2304
    T+5 | ENTER | Norman Niles #3 Score: 0.2226
    T+5 | ENTER | Norman Niles #4 Score: 0.2486
    T+5 | EXIT  | Norman Niles #1 Score: 0.4591
    T+5 | EXIT  | Norman Niles #2 Score: 0.4480
    T+5 | EXIT  | Norman Niles #3 Score: 0.4305
    T+5 | EXIT  | Norman Niles #4 Score: 0.4192

ðŸŽ¯ Training: T+6
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>ðŸš€ Total Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 32/40 [04:23&lt;00:48,  6.07s/it]</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    T+6 | ENTER | Norman Niles #1 Score: 0.2522
    T+6 | ENTER | Norman Niles #2 Score: 0.2247
    T+6 | ENTER | Norman Niles #3 Score: 0.2229
    T+6 | ENTER | Norman Niles #4 Score: 0.2629
    T+6 | EXIT  | Norman Niles #1 Score: 0.4591
    T+6 | EXIT  | Norman Niles #2 Score: 0.4480
    T+6 | EXIT  | Norman Niles #3 Score: 0.4318
    T+6 | EXIT  | Norman Niles #4 Score: 0.4205

ðŸŽ¯ Training: T+7
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>ðŸš€ Total Progress: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [05:35&lt;00:00,  8.39s/it]</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>    T+7 | ENTER | Norman Niles #1 Score: 0.2595
    T+7 | ENTER | Norman Niles #2 Score: 0.2257
    T+7 | ENTER | Norman Niles #3 Score: 0.2282
    T+7 | ENTER | Norman Niles #4 Score: 0.2543
    T+7 | EXIT  | Norman Niles #1 Score: 0.4591
    T+7 | EXIT  | Norman Niles #2 Score: 0.4480
    T+7 | EXIT  | Norman Niles #3 Score: 0.4318
    T+7 | EXIT  | Norman Niles #4 Score: 0.4205

================================================================================
TRAINING SUMMARY
================================================================================

Average scores by task:
  ENTER: 0.2401
  EXIT: 0.4393

Average scores by timestep:
  T+3: 0.3403
  T+4: 0.3386
  T+5: 0.3385
  T+6: 0.3403
  T+7: 0.3409

Overall average: 0.3397

================================================================================
GENERATING PREDICTIONS
================================================================================

  Processing Norman Niles #1...
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>
  Processing Norman Niles #2...

  Processing Norman Niles #3...

  Processing Norman Niles #4...

================================================================================
CREATING SUBMISSION
================================================================================
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>Processing predictions: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 176/176 [00:00&lt;00:00, 188797.32it/s]
Filling submission: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1760/1760 [00:00&lt;00:00, 13464.47it/s]</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>  Filled: 1760/1760 (100.0%)

  ðŸ“ˆ PREDICTION DISTRIBUTION:
    free flowing        :  1540 ( 87.5%)
    heavy delay         :   118 (  6.7%)
    moderate delay      :    85 (  4.8%)
    light delay         :    17 (  1.0%)
ðŸ” Checking uniqueness of submission_specialized_et_time_based_20251201_083017.csv...
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr"><pre>
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>âœ… UNIQUE - Different from all 69 existing submission(s)
</pre></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output" data-mime-type="text/html"><a href="https://kkb-production.jupyter-proxy.kaggle.net/files/submissions/submission_specialized_et_time_based_20251201_083017.csv" target="_blank" rel="noopener">./submissions/submission_specialized_et_time_based_20251201_083017.csv</a><br></div></div><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>
âœ… Training complete!
</pre></div></div><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell" aria-label="Code Cell Content with Output" tabindex="-1" data-windowed-list-index="11" data-uuid="3c37500f-9852-4ef5-a658-b6a6935603dc" id="3c37500f-9852-4ef5-a658-b6a6935603dc" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[20]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 2978px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">999</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div><div class="cm-gutterElement" style="height: 14px;">2</div><div class="cm-gutterElement" style="height: 14px;">3</div><div class="cm-gutterElement" style="height: 14px;">4</div><div class="cm-gutterElement" style="height: 14px;">5</div><div class="cm-gutterElement" style="height: 14px;">6</div><div class="cm-gutterElement" style="height: 14px;">7</div><div class="cm-gutterElement" style="height: 14px;">8</div><div class="cm-gutterElement" style="height: 14px;">9</div><div class="cm-gutterElement" style="height: 14px;">10</div><div class="cm-gutterElement" style="height: 14px;">11</div><div class="cm-gutterElement" style="height: 14px;">12</div><div class="cm-gutterElement" style="height: 14px;">13</div><div class="cm-gutterElement" style="height: 14px;">14</div><div class="cm-gutterElement" style="height: 14px;">15</div><div class="cm-gutterElement" style="height: 14px;">16</div><div class="cm-gutterElement" style="height: 14px;">17</div><div class="cm-gutterElement" style="height: 14px;">18</div><div class="cm-gutterElement" style="height: 14px;">19</div><div class="cm-gutterElement" style="height: 14px;">20</div><div class="cm-gutterElement" style="height: 14px;">21</div><div class="cm-gutterElement" style="height: 14px;">22</div><div class="cm-gutterElement" style="height: 14px;">23</div><div class="cm-gutterElement" style="height: 14px;">24</div><div class="cm-gutterElement" style="height: 14px;">25</div><div class="cm-gutterElement" style="height: 14px;">26</div><div class="cm-gutterElement" style="height: 14px;">27</div><div class="cm-gutterElement" style="height: 14px;">28</div><div class="cm-gutterElement" style="height: 14px;">29</div><div class="cm-gutterElement" style="height: 14px;">30</div><div class="cm-gutterElement" style="height: 14px;">31</div><div class="cm-gutterElement" style="height: 14px;">32</div><div class="cm-gutterElement" style="height: 14px;">33</div><div class="cm-gutterElement" style="height: 14px;">34</div><div class="cm-gutterElement" style="height: 14px;">35</div><div class="cm-gutterElement" style="height: 14px;">36</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><span class="Í¼14"># MD:</span></div><div class="cm-line"><span class="Í¼14">#: CELL 3: Random CV Search for Best Hyperparameters</span></div><div class="cm-line"><span class="Í¼14">#: ============================================</span></div><div class="cm-line"><span class="Í¼14">#: This cell performs randomized cross-validation search to find optimal</span></div><div class="cm-line"><span class="Í¼14">#: hyperparameters for both XGBoost and ExtraTrees models</span></div><div class="cm-line"><span class="Í¼14">#: Uses: T=0, one camera, both tasks (enter/exit), interleaved split</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">from</span> sklearn<span class="Í¼1c">.</span>model_selection <span class="Í¼v">import</span> RandomizedSearchCV</div><div class="cm-line"><span class="Í¼v">from</span> scipy<span class="Í¼1c">.</span>stats <span class="Í¼v">import</span> uniform<span class="Í¼1c">,</span> randint</div><div class="cm-line"><span class="Í¼v">import</span> numpy <span class="Í¼v">as</span> np</div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼14"># Configuration</span></div><div class="cm-line">SEARCH_CAMERA <span class="Í¼13">=</span> <span class="Í¼15">'Norman Niles #1'</span>  <span class="Í¼14"># Choose camera for hyperparameter search</span></div><div class="cm-line">SEARCH_TIMESTEP <span class="Í¼13">=</span> <span class="Í¼x">0</span>         <span class="Í¼14"># T+3 (first timestep)</span></div><div class="cm-line">N_ITER_SEARCH <span class="Í¼13">=</span> <span class="Í¼x">20</span>          <span class="Í¼14"># Number of random combinations to try</span></div><div class="cm-line">CV_FOLDS <span class="Í¼13">=</span> <span class="Í¼x">3</span>                <span class="Í¼14"># Cross-validation folds</span></div><div class="cm-line">MODEL_TYPE <span class="Í¼13">=</span> <span class="Í¼15">'et'</span>           <span class="Í¼14"># 'xgb' or 'et'</span></div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">def</span> <span class="Í¼y">custom_scorer</span><span class="Í¼1c">(</span>y_true<span class="Í¼1c">,</span> y_pred<span class="Í¼1c">)</span>:</div><div class="cm-line">    <span class="Í¼15">"""Custom scoring function: 0.7*F1 + 0.3*Accuracy"""</span></div><div class="cm-line">    <span class="Í¼v">from</span> sklearn<span class="Í¼1c">.</span>metrics <span class="Í¼v">import</span> f1_score<span class="Í¼1c">,</span> accuracy_score</div><div class="cm-line">    f1 <span class="Í¼13">=</span> f1_score<span class="Í¼1c">(</span>y_true<span class="Í¼1c">,</span> y_pred<span class="Í¼1c">,</span> average<span class="Í¼13">=</span><span class="Í¼15">"macro"</span><span class="Í¼1c">)</span></div><div class="cm-line">    acc <span class="Í¼13">=</span> accuracy_score<span class="Í¼1c">(</span>y_true<span class="Í¼1c">,</span> y_pred<span class="Í¼1c">)</span></div><div class="cm-line">    <span class="Í¼v">return</span> <span class="Í¼x">0.7</span> <span class="Í¼13">*</span> f1 <span class="Í¼13">+</span> <span class="Í¼x">0.3</span> <span class="Í¼13">*</span> acc</div><div class="cm-line"><br></div><div class="cm-line"><span class="Í¼v">def</span> <span class="Í¼y">get_xgb_param_distributions</span><span class="Í¼1c">(</span><span class="Í¼1c">)</span>:</div><div class="cm-line">    <span class="Í¼15">"""Define parameter distributions for XGBoost random search"""</span></div><div class="cm-line">    <span class="Í¼v">return</span> <span class="Í¼17">{</span></div><div class="cm-line">        <span class="Í¼15">'n_estimators'</span>: randint<span class="Í¼1c">(</span><span class="Í¼x">100</span><span class="Í¼1c">,</span> <span class="Í¼x">400</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'learning_rate'</span>: uniform<span class="Í¼1c">(</span><span class="Í¼x">0.01</span><span class="Í¼1c">,</span> <span class="Í¼x">0.15</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'max_depth'</span>: randint<span class="Í¼1c">(</span><span class="Í¼x">4</span><span class="Í¼1c">,</span> <span class="Í¼x">10</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'colsample_bytree'</span>: uniform<span class="Í¼1c">(</span><span class="Í¼x">0.03</span><span class="Í¼1c">,</span> <span class="Í¼x">0.15</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'subsample'</span>: uniform<span class="Í¼1c">(</span><span class="Í¼x">0.7</span><span class="Í¼1c">,</span> <span class="Í¼x">0.25</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'reg_alpha'</span>: uniform<span class="Í¼1c">(</span><span class="Í¼x">0.0</span><span class="Í¼1c">,</span> <span class="Í¼x">0.5</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'reg_lambda'</span>: uniform<span class="Í¼1c">(</span><span class="Í¼x">0.5</span><span class="Í¼1c">,</span> <span class="Í¼x">2.0</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span></div><div class="cm-line">        <span class="Í¼15">'min_child_weight'</span>: randint<span class="Í¼1c">(</span><span class="Í¼x">3</span><span class="Í¼1c">,</span> <span class="Í¼x">12</span><span class="Í¼1c">)</span><span class="Í¼1c">,</span></div><div class="cm-gap" style="height: 2450px;"></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.6641px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="lm-Widget lm-Panel jp-OutputArea-child"><div class="lm-Widget jp-OutputPrompt jp-OutputArea-prompt"></div><div class="lm-Widget jp-RenderedText jp-mod-trusted jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stdout"><pre>
################################################################################
# RANDOM CV HYPERPARAMETER SEARCH
# Model type: et
# Camera: Norman Niles #1
# Timestep: T+3
# Iterations: 20
# CV Folds: 3
################################################################################


================================================================================
SEARCHING: ENTER
================================================================================

Loading: train_t0_enter_Norman_Niles_1.pkl
Data shape: (1586, 60004)
Class distribution:
  Class 0: 698 (44.0%)
  Class 1: 292 (18.4%)
  Class 2: 271 (17.1%)
  Class 3: 325 (20.5%)

ðŸ” Starting randomized search...
Parameters to optimize: ['n_estimators', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'max_features', 'bootstrap', 'class_weight']
Fitting 3 folds for each of 20 candidates, totalling 60 fits

================================================================================
RESULTS: ENTER
================================================================================

âœ¨ Best Score (CV): 0.3385

ðŸŽ¯ Best Parameters:
  bootstrap           : True
  class_weight        : balanced
  max_depth           : 29
  max_features        : 0.011866626528544618
  min_samples_leaf    : 5
  min_samples_split   : 5
  n_estimators        : 257

ðŸ“Š Top 5 Parameter Combinations:

  Rank 1: Score = 0.3385 (Â±0.0437)
    bootstrap           : True
    class_weight        : balanced
    max_depth           : 29
    max_features        : 0.011866626528544618
    min_samples_leaf    : 5
    min_samples_split   : 5
    n_estimators        : 257

  Rank 2: Score = 0.3349 (Â±0.0438)
    bootstrap           : True
    class_weight        : balanced
    max_depth           : 34
    max_features        : 0.0385297914889198
    min_samples_leaf    : 2
    min_samples_split   : 7
    n_estimators        : 367

  Rank 3: Score = 0.3343 (Â±0.0420)
    bootstrap           : True
    class_weight        : balanced
    max_depth           : 20
    max_features        : 0.017948627261366895
    min_samples_leaf    : 4
    min_samples_split   : 5
    n_estimators        : 230

  Rank 4: Score = 0.3336 (Â±0.0414)
    bootstrap           : True
    class_weight        : balanced
    max_depth           : 33
    max_features        : 0.02975182385457563
    min_samples_leaf    : 2
    min_samples_split   : 5
    n_estimators        : 212

  Rank 5: Score = 0.3320 (Â±0.0391)
    bootstrap           : True
    class_weight        : None
    max_depth           : 32
    max_features        : 0.015636968998990506
    min_samples_leaf    : 6
    min_samples_split   : 3
    n_estimators        : 238

================================================================================
SEARCHING: EXIT
================================================================================

Loading: train_t0_exit_Norman_Niles_1.pkl
Data shape: (1586, 60004)
Class distribution:
  Class 0: 1488 (93.8%)
  Class 1: 26 (1.6%)
  Class 2: 27 (1.7%)
  Class 3: 45 (2.8%)

ðŸ” Starting randomized search...
Parameters to optimize: ['n_estimators', 'max_depth', 'min_samples_split', 'min_samples_leaf', 'max_features', 'bootstrap']
Fitting 3 folds for each of 20 candidates, totalling 60 fits

================================================================================
RESULTS: EXIT
================================================================================

âœ¨ Best Score (CV): 0.4726

ðŸŽ¯ Best Parameters:
  bootstrap           : True
  max_depth           : 21
  max_features        : 0.010922497001656631
  min_samples_leaf    : 5
  min_samples_split   : 15
  n_estimators        : 71

ðŸ“Š Top 5 Parameter Combinations:

  Rank 1: Score = 0.4726 (Â±0.0305)
    bootstrap           : True
    max_depth           : 21
    max_features        : 0.010922497001656631
    min_samples_leaf    : 5
    min_samples_split   : 15
    n_estimators        : 71

  Rank 2: Score = 0.4601 (Â±0.0129)
    bootstrap           : False
    max_depth           : 10
    max_features        : 0.017948627261366895
    min_samples_leaf    : 9
    min_samples_split   : 15
    n_estimators        : 37

  Rank 3: Score = 0.4594 (Â±0.0118)
    bootstrap           : False
    max_depth           : 21
    max_features        : 0.017336180394137354
    min_samples_leaf    : 6
    min_samples_split   : 14
    n_estimators        : 51

  Rank 4: Score = 0.4593 (Â±0.0118)
    bootstrap           : False
    max_depth           : 19
    max_features        : 0.045793094017105955
    min_samples_leaf    : 8
    min_samples_split   : 19
    n_estimators        : 77

  Rank 5: Score = 0.4588 (Â±0.0111)
    bootstrap           : True
    max_depth           : 17
    max_features        : 0.03281775897621598
    min_samples_leaf    : 6
    min_samples_split   : 13
    n_estimators        : 91

================================================================================
FINAL SUMMARY
================================================================================

Best CV Scores:
  ENTER: 0.3385
  EXIT:  0.4726

ðŸ“‹ Recommended Parameters for Production:

# ENTER task parameters:
params_enter = {
    'bootstrap': True,
    'class_weight': 'balanced',
    'max_depth': 29,
    'max_features': 0.011866626528544618,
    'min_samples_leaf': 5,
    'min_samples_split': 5,
    'n_estimators': 257,
}

# EXIT task parameters:
params_exit = {
    'bootstrap': True,
    'max_depth': 21,
    'max_features': 0.010922497001656631,
    'min_samples_leaf': 5,
    'min_samples_split': 15,
    'n_estimators': 71,
}

âœ… Hyperparameter search complete!
[CV] END bootstrap=True, class_weight=None, max_depth=34, max_features=0.03927975767245621, min_samples_leaf=6, min_samples_split=7, n_estimators=252; total time= 2.4min
[CV] END bootstrap=False, class_weight=balanced, max_depth=21, max_features=0.03887995089067299, min_samples_leaf=7, min_samples_split=8, n_estimators=279; total time= 4.2min
[CV] END bootstrap=False, class_weight=None, max_depth=20, max_features=0.02216968971838151, min_samples_leaf=7, min_samples_split=11, n_estimators=198; total time= 1.7min
[CV] END bootstrap=True, class_weight=balanced, max_depth=29, max_features=0.011866626528544618, min_samples_leaf=5, min_samples_split=5, n_estimators=257; total time=  45.3s
[CV] END bootstrap=True, class_weight=None, max_depth=22, max_features=0.04439761626945282, min_samples_leaf=6, min_samples_split=11, n_estimators=316; total time= 3.4min
[CV] END bootstrap=False, class_weight=None, max_depth=34, max_features=0.03733054075301833, min_samples_leaf=5, min_samples_split=10, n_estimators=324; total time= 5.4min
[CV] END bootstrap=True, class_weight=None, max_depth=36, max_features=0.020351199264000676, min_samples_leaf=5, min_samples_split=4, n_estimators=283; total time= 1.5min
[CV] END bootstrap=True, class_weight=None, max_depth=36, max_features=0.020351199264000676, min_samples_leaf=5, min_samples_split=4, n_estimators=283; total time= 1.4min
[CV] END bootstrap=False, class_weight=None, max_depth=23, max_features=0.017394178221021083, min_samples_leaf=3, min_samples_split=4, n_estimators=351; total time= 3.0min
[CV] END bootstrap=False, class_weight=None, max_depth=35, max_features=0.03989280440549524, min_samples_leaf=6, min_samples_split=10, n_estimators=303; total time= 5.3min
[CV] END bootstrap=False, class_weight=None, max_depth=35, max_features=0.03989280440549524, min_samples_leaf=6, min_samples_split=10, n_estimators=303; total time= 4.8min
[CV] END bootstrap=False, class_weight=balanced, max_depth=22, max_features=0.04085081386743783, min_samples_leaf=6, min_samples_split=9, n_estimators=399; total time= 6.8min
[CV] END bootstrap=True, class_weight=balanced, max_depth=34, max_features=0.0385297914889198, min_samples_leaf=2, min_samples_split=7, n_estimators=367; total time= 3.8min
[CV] END bootstrap=True, class_weight=balanced, max_depth=34, max_features=0.0385297914889198, min_samples_leaf=2, min_samples_split=7, n_estimators=367; total time= 3.8min
[CV] END bootstrap=True, max_depth=13, max_features=0.04802857225639665, min_samples_leaf=5, min_samples_split=12, n_estimators=90; total time= 1.2min
[CV] END bootstrap=True, max_depth=15, max_features=0.012256463161084011, min_samples_leaf=6, min_samples_split=18, n_estimators=67; total time=  11.9s
[CV] END bootstrap=True, max_depth=21, max_features=0.010922497001656631, min_samples_leaf=5, min_samples_split=15, n_estimators=71; total time=  15.6s
[CV] END bootstrap=True, max_depth=21, max_features=0.010922497001656631, min_samples_leaf=5, min_samples_split=15, n_estimators=71; total time=  12.8s
[CV] END bootstrap=True, max_depth=23, max_features=0.017986951286334388, min_samples_leaf=9, min_samples_split=8, n_estimators=93; total time=  24.8s
[CV] END bootstrap=True, max_depth=23, max_features=0.017986951286334388, min_samples_leaf=9, min_samples_split=8, n_estimators=93; total time=  24.7s
[CV] END bootstrap=True, max_depth=23, max_features=0.017986951286334388, min_samples_leaf=9, min_samples_split=8, n_estimators=93; total time=  21.6s
[CV] END bootstrap=True, max_depth=12, max_features=0.04439761626945282, min_samples_leaf=9, min_samples_split=9, n_estimators=68; total time=  39.1s
[CV] END bootstrap=False, max_depth=13, max_features=0.047688070227394116, min_samples_leaf=8, min_samples_split=6, n_estimators=38; total time=  48.6s
[CV] END bootstrap=False, max_depth=14, max_features=0.019235753024885963, min_samples_leaf=6, min_samples_split=19, n_estimators=89; total time=  45.8s
[CV] END bootstrap=True, max_depth=21, max_features=0.029807076404450808, min_samples_leaf=9, min_samples_split=7, n_estimators=65; total time=  22.7s
[CV] END bootstrap=False, max_depth=13, max_features=0.017394178221021083, min_samples_leaf=9, min_samples_split=6, n_estimators=73; total time=  35.6s
[CV] END bootstrap=False, max_depth=13, max_features=0.017394178221021083, min_samples_leaf=9, min_samples_split=6, n_estimators=73; total time=  37.9s
[CV] END bootstrap=False, max_depth=13, max_features=0.017394178221021083, min_samples_leaf=9, min_samples_split=6, n_estimators=73; total time=  27.7s
[CV] END bootstrap=True, max_depth=17, max_features=0.03281775897621598, min_samples_leaf=6, min_samples_split=13, n_estimators=91; total time=  51.5s
[CV] END bootstrap=True, max_depth=17, max_features=0.03281775897621598, min_samples_leaf=6, min_samples_split=13, n_estimators=91; total time=  50.2s
[CV] END bootstrap=False, max_depth=14, max_features=0.02554709158757928, min_samples_leaf=4, min_samples_split=19, n_estimators=82; total time= 1.0min
[CV] END bootstrap=True, max_depth=24, max_features=0.0166106775625201, min_samples_leaf=3, min_samples_split=11, n_estimators=38; total time=  15.9s
[CV] END bootstrap=True, max_depth=24, max_features=0.0166106775625201, min_samples_leaf=3, min_samples_split=11, n_estimators=38; total time=  17.6s
[CV] END bootstrap=True, max_depth=24, max_features=0.0166106775625201, min_samples_leaf=3, min_samples_split=11, n_estimators=38; total time=  14.0s
[CV] END bootstrap=False, max_depth=10, max_features=0.017948627261366895, min_samples_leaf=9, min_samples_split=15, n_estimators=37; total time=  15.2s
[CV] END bootstrap=False, max_depth=10, max_features=0.017948627261366895, min_samples_leaf=9, min_samples_split=15, n_estimators=37; total time=  13.0s
[CV] END bootstrap=True, class_weight=None, max_depth=34, max_features=0.03927975767245621, min_samples_leaf=6, min_samples_split=7, n_estimators=252; total time= 2.2min
[CV] END bootstrap=False, class_weight=balanced, max_depth=30, max_features=0.028369955678634685, min_samples_leaf=6, min_samples_split=6, n_estimators=253; total time= 3.0min
[CV] END bootstrap=False, class_weight=balanced, max_depth=21, max_features=0.03887995089067299, min_samples_leaf=7, min_samples_split=8, n_estimators=279; total time= 4.3min
[CV] END bootstrap=False, class_weight=None, max_depth=33, max_features=0.042335893924658446, min_samples_leaf=2, min_samples_split=7, n_estimators=279; total time= 6.1min
[CV] END bootstrap=False, class_weight=None, max_depth=34, max_features=0.03733054075301833, min_samples_leaf=5, min_samples_split=10, n_estimators=324; total time= 4.9min
[CV] END bootstrap=False, class_weight=None, max_depth=23, max_features=0.017394178221021083, min_samples_leaf=3, min_samples_split=4, n_estimators=351; total time= 2.9min
[CV] END bootstrap=False, class_weight=None, max_depth=33, max_features=0.03909087983425684, min_samples_leaf=7, min_samples_split=9, n_estimators=398; total time= 6.5min
[CV] END bootstrap=True, class_weight=None, max_depth=32, max_features=0.015636968998990506, min_samples_leaf=6, min_samples_split=3, n_estimators=238; total time=  52.6s
[CV] END bootstrap=True, class_weight=balanced, max_depth=20, max_features=0.017948627261366895, min_samples_leaf=4, min_samples_split=5, n_estimators=230; total time= 1.1min
[CV] END bootstrap=True, class_weight=balanced, max_depth=20, max_features=0.017948627261366895, min_samples_leaf=4, min_samples_split=5, n_estimators=230; total time= 1.1min
[CV] END bootstrap=False, class_weight=balanced, max_depth=22, max_features=0.04085081386743783, min_samples_leaf=6, min_samples_split=9, n_estimators=399; total time= 6.5min
[CV] END bootstrap=False, class_weight=balanced, max_depth=24, max_features=0.039184247133522566, min_samples_leaf=7, min_samples_split=5, n_estimators=342; total time= 5.2min
[CV] END bootstrap=True, class_weight=balanced, max_depth=33, max_features=0.02975182385457563, min_samples_leaf=2, min_samples_split=5, n_estimators=212; total time= 1.7min
[CV] END bootstrap=True, class_weight=balanced, max_depth=33, max_features=0.02975182385457563, min_samples_leaf=2, min_samples_split=5, n_estimators=212; total time= 1.9min
[CV] END bootstrap=False, class_weight=balanced, max_depth=36, max_features=0.022574239243053067, min_samples_leaf=5, min_samples_split=7, n_estimators=300; total time= 1.8min
[CV] END bootstrap=True, max_depth=16, max_features=0.027833310114143646, min_samples_leaf=9, min_samples_split=15, n_estimators=53; total time=  21.6s
[CV] END bootstrap=True, max_depth=16, max_features=0.027833310114143646, min_samples_leaf=9, min_samples_split=15, n_estimators=53; total time=  22.7s
[CV] END bootstrap=True, max_depth=16, max_features=0.027833310114143646, min_samples_leaf=9, min_samples_split=15, n_estimators=53; total time=  19.8s
[CV] END bootstrap=True, max_depth=15, max_features=0.012256463161084011, min_samples_leaf=6, min_samples_split=18, n_estimators=67; total time=  12.2s
[CV] END bootstrap=False, max_depth=21, max_features=0.017336180394137354, min_samples_leaf=6, min_samples_split=14, n_estimators=51; total time=  26.5s
[CV] END bootstrap=False, max_depth=21, max_features=0.04895022075365837, min_samples_leaf=9, min_samples_split=18, n_estimators=91; total time= 2.0min
[CV] END bootstrap=False, max_depth=13, max_features=0.047688070227394116, min_samples_leaf=8, min_samples_split=6, n_estimators=38; total time=  50.2s
[CV] END bootstrap=False, max_depth=14, max_features=0.019235753024885963, min_samples_leaf=6, min_samples_split=19, n_estimators=89; total time=  47.8s
[CV] END bootstrap=False, max_depth=17, max_features=0.0402144564127061, min_samples_leaf=8, min_samples_split=10, n_estimators=83; total time= 1.7min
[CV] END bootstrap=False, max_depth=19, max_features=0.045793094017105955, min_samples_leaf=8, min_samples_split=19, n_estimators=77; total time= 1.7min
[CV] END bootstrap=False, max_depth=14, max_features=0.02554709158757928, min_samples_leaf=4, min_samples_split=19, n_estimators=82; total time= 1.0min
[CV] END bootstrap=False, max_depth=19, max_features=0.04861021229056552, min_samples_leaf=6, min_samples_split=16, n_estimators=70; total time= 1.5min
[CV] END bootstrap=True, max_depth=12, max_features=0.04085081386743783, min_samples_leaf=7, min_samples_split=14, n_estimators=70; total time=  32.7s
[CV] END bootstrap=True, class_weight=None, max_depth=34, max_features=0.03927975767245621, min_samples_leaf=6, min_samples_split=7, n_estimators=252; total time= 2.3min
[CV] END bootstrap=False, class_weight=balanced, max_depth=30, max_features=0.028369955678634685, min_samples_leaf=6, min_samples_split=6, n_estimators=253; total time= 3.1min
[CV] END bootstrap=False, class_weight=None, max_depth=20, max_features=0.02216968971838151, min_samples_leaf=7, min_samples_split=11, n_estimators=198; total time= 1.8min
[CV] END bootstrap=False, class_weight=None, max_depth=20, max_features=0.02216968971838151, min_samples_leaf=7, min_samples_split=11, n_estimators=198; total time= 1.8min
[CV] END bootstrap=True, class_weight=None, max_depth=22, max_features=0.04439761626945282, min_samples_leaf=6, min_samples_split=11, n_estimators=316; total time= 3.2min
[CV] END bootstrap=False, class_weight=None, max_depth=33, max_features=0.042335893924658446, min_samples_leaf=2, min_samples_split=7, n_estimators=279; total time= 5.5min
[CV] END bootstrap=False, class_weight=None, max_depth=34, max_features=0.03733054075301833, min_samples_leaf=5, min_samples_split=10, n_estimators=324; total time= 5.3min
[CV] END bootstrap=False, class_weight=None, max_depth=33, max_features=0.03909087983425684, min_samples_leaf=7, min_samples_split=9, n_estimators=398; total time= 6.1min
[CV] END bootstrap=False, class_weight=None, max_depth=35, max_features=0.03989280440549524, min_samples_leaf=6, min_samples_split=10, n_estimators=303; total time= 5.1min
[CV] END bootstrap=True, class_weight=None, max_depth=26, max_features=0.044001543111591976, min_samples_leaf=5, min_samples_split=4, n_estimators=182; total time= 2.1min
[CV] END bootstrap=True, class_weight=None, max_depth=26, max_features=0.044001543111591976, min_samples_leaf=5, min_samples_split=4, n_estimators=182; total time= 1.9min
[CV] END bootstrap=True, class_weight=None, max_depth=26, max_features=0.044001543111591976, min_samples_leaf=5, min_samples_split=4, n_estimators=182; total time= 2.0min
[CV] END bootstrap=False, class_weight=balanced, max_depth=24, max_features=0.039184247133522566, min_samples_leaf=7, min_samples_split=5, n_estimators=342; total time= 5.4min
[CV] END bootstrap=True, class_weight=balanced, max_depth=33, max_features=0.02975182385457563, min_samples_leaf=2, min_samples_split=5, n_estimators=212; total time= 1.9min
[CV] END bootstrap=False, class_weight=balanced, max_depth=36, max_features=0.022574239243053067, min_samples_leaf=5, min_samples_split=7, n_estimators=300; total time= 2.3min
[CV] END bootstrap=True, max_depth=13, max_features=0.04802857225639665, min_samples_leaf=5, min_samples_split=12, n_estimators=90; total time= 1.2min
[CV] END bootstrap=False, max_depth=21, max_features=0.017336180394137354, min_samples_leaf=6, min_samples_split=14, n_estimators=51; total time=  28.9s
[CV] END bootstrap=True, max_depth=21, max_features=0.010922497001656631, min_samples_leaf=5, min_samples_split=15, n_estimators=71; total time=  11.3s
[CV] END bootstrap=False, max_depth=21, max_features=0.04895022075365837, min_samples_leaf=9, min_samples_split=18, n_estimators=91; total time= 1.8min
[CV] END bootstrap=True, max_depth=12, max_features=0.04439761626945282, min_samples_leaf=9, min_samples_split=9, n_estimators=68; total time=  41.1s
[CV] END bootstrap=False, max_depth=14, max_features=0.019235753024885963, min_samples_leaf=6, min_samples_split=19, n_estimators=89; total time=  49.6s
[CV] END bootstrap=True, max_depth=21, max_features=0.029807076404450808, min_samples_leaf=9, min_samples_split=7, n_estimators=65; total time=  26.4s
[CV] END bootstrap=False, max_depth=17, max_features=0.0402144564127061, min_samples_leaf=8, min_samples_split=10, n_estimators=83; total time= 1.5min
[CV] END bootstrap=False, max_depth=19, max_features=0.045793094017105955, min_samples_leaf=8, min_samples_split=19, n_estimators=77; total time= 1.7min
[CV] END bootstrap=False, max_depth=14, max_features=0.02554709158757928, min_samples_leaf=4, min_samples_split=19, n_estimators=82; total time= 1.1min
[CV] END bootstrap=False, max_depth=19, max_features=0.04861021229056552, min_samples_leaf=6, min_samples_split=16, n_estimators=70; total time= 1.6min
[CV] END bootstrap=True, max_depth=12, max_features=0.04085081386743783, min_samples_leaf=7, min_samples_split=14, n_estimators=70; total time=  27.3s
[CV] END bootstrap=False, class_weight=balanced, max_depth=30, max_features=0.028369955678634685, min_samples_leaf=6, min_samples_split=6, n_estimators=253; total time= 2.8min
[CV] END bootstrap=False, class_weight=balanced, max_depth=21, max_features=0.03887995089067299, min_samples_leaf=7, min_samples_split=8, n_estimators=279; total time= 4.3min
[CV] END bootstrap=True, class_weight=balanced, max_depth=29, max_features=0.011866626528544618, min_samples_leaf=5, min_samples_split=5, n_estimators=257; total time=  46.8s
[CV] END bootstrap=True, class_weight=balanced, max_depth=29, max_features=0.011866626528544618, min_samples_leaf=5, min_samples_split=5, n_estimators=257; total time=  46.6s
[CV] END bootstrap=True, class_weight=None, max_depth=22, max_features=0.04439761626945282, min_samples_leaf=6, min_samples_split=11, n_estimators=316; total time= 3.5min
[CV] END bootstrap=False, class_weight=None, max_depth=33, max_features=0.042335893924658446, min_samples_leaf=2, min_samples_split=7, n_estimators=279; total time= 5.9min
[CV] END bootstrap=True, class_weight=None, max_depth=36, max_features=0.020351199264000676, min_samples_leaf=5, min_samples_split=4, n_estimators=283; total time= 1.4min
[CV] END bootstrap=False, class_weight=None, max_depth=23, max_features=0.017394178221021083, min_samples_leaf=3, min_samples_split=4, n_estimators=351; total time= 3.0min
[CV] END bootstrap=False, class_weight=None, max_depth=33, max_features=0.03909087983425684, min_samples_leaf=7, min_samples_split=9, n_estimators=398; total time= 6.5min
[CV] END bootstrap=True, class_weight=None, max_depth=32, max_features=0.015636968998990506, min_samples_leaf=6, min_samples_split=3, n_estimators=238; total time=  56.2s
[CV] END bootstrap=True, class_weight=None, max_depth=32, max_features=0.015636968998990506, min_samples_leaf=6, min_samples_split=3, n_estimators=238; total time=  54.7s
[CV] END bootstrap=True, class_weight=balanced, max_depth=20, max_features=0.017948627261366895, min_samples_leaf=4, min_samples_split=5, n_estimators=230; total time= 1.1min
[CV] END bootstrap=False, class_weight=balanced, max_depth=22, max_features=0.04085081386743783, min_samples_leaf=6, min_samples_split=9, n_estimators=399; total time= 6.5min
[CV] END bootstrap=False, class_weight=balanced, max_depth=24, max_features=0.039184247133522566, min_samples_leaf=7, min_samples_split=5, n_estimators=342; total time= 5.1min
[CV] END bootstrap=True, class_weight=balanced, max_depth=34, max_features=0.0385297914889198, min_samples_leaf=2, min_samples_split=7, n_estimators=367; total time= 3.8min
[CV] END bootstrap=False, class_weight=balanced, max_depth=36, max_features=0.022574239243053067, min_samples_leaf=5, min_samples_split=7, n_estimators=300; total time= 2.3min
[CV] END bootstrap=True, max_depth=13, max_features=0.04802857225639665, min_samples_leaf=5, min_samples_split=12, n_estimators=90; total time= 1.1min
[CV] END bootstrap=True, max_depth=15, max_features=0.012256463161084011, min_samples_leaf=6, min_samples_split=18, n_estimators=67; total time=  12.9s
[CV] END bootstrap=False, max_depth=21, max_features=0.017336180394137354, min_samples_leaf=6, min_samples_split=14, n_estimators=51; total time=  23.5s
[CV] END bootstrap=False, max_depth=21, max_features=0.04895022075365837, min_samples_leaf=9, min_samples_split=18, n_estimators=91; total time= 1.9min
[CV] END bootstrap=True, max_depth=12, max_features=0.04439761626945282, min_samples_leaf=9, min_samples_split=9, n_estimators=68; total time=  37.6s
[CV] END bootstrap=False, max_depth=13, max_features=0.047688070227394116, min_samples_leaf=8, min_samples_split=6, n_estimators=38; total time=  44.2s
[CV] END bootstrap=True, max_depth=21, max_features=0.029807076404450808, min_samples_leaf=9, min_samples_split=7, n_estimators=65; total time=  26.9s
[CV] END bootstrap=False, max_depth=17, max_features=0.0402144564127061, min_samples_leaf=8, min_samples_split=10, n_estimators=83; total time= 1.6min
[CV] END bootstrap=False, max_depth=19, max_features=0.045793094017105955, min_samples_leaf=8, min_samples_split=19, n_estimators=77; total time= 1.5min
[CV] END bootstrap=True, max_depth=17, max_features=0.03281775897621598, min_samples_leaf=6, min_samples_split=13, n_estimators=91; total time=  41.9s
[CV] END bootstrap=False, max_depth=19, max_features=0.04861021229056552, min_samples_leaf=6, min_samples_split=16, n_estimators=70; total time= 1.9min
[CV] END bootstrap=False, max_depth=10, max_features=0.017948627261366895, min_samples_leaf=9, min_samples_split=15, n_estimators=37; total time=  14.1s
[CV] END bootstrap=True, max_depth=12, max_features=0.04085081386743783, min_samples_leaf=7, min_samples_split=14, n_estimators=70; total time=  28.7s
</pre></div></div><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div><div class="lm-Widget jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" aria-label="Code Cell Content" tabindex="-1" data-windowed-list-index="12" data-uuid="7f472ecc-6348-485e-a877-9286f6e7f1f2" id="7f472ecc-6348-485e-a877-9286f6e7f1f2" data-bootstrap="done"><div class="lm-Widget jp-CellHeader jp-Cell-header"></div><div class="lm-Widget lm-Panel jp-Cell-inputWrapper"><div class="lm-Widget jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-InputArea jp-Cell-inputArea"><div class="lm-Widget jp-InputPrompt jp-InputArea-prompt">[ ]:</div><div class="lm-Widget jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline"><div class="cm-editor Í¼4 Í¼5 Í¼7 Í¼r" style=""><div class="cm-announced" aria-live="polite"></div><div tabindex="-1" class="cm-scroller"><div class="cm-gutters" aria-hidden="true" style="min-height: 38px; position: sticky;"><div class="cm-gutter cm-lineNumbers"><div class="cm-gutterElement" style="height: 0px; visibility: hidden; pointer-events: none;">9</div><div class="cm-gutterElement" style="height: 14px; margin-top: 12px;">1</div></div></div><div spellcheck="false" autocorrect="off" autocapitalize="off" translate="no" contenteditable="true" class="cm-content" role="textbox" aria-multiline="true" tabindex="-1" data-language="python" style="tab-size: 4;"><div class="cm-line"><br></div></div><div class="cm-layer cm-layer-above cm-cursorLayer" aria-hidden="true" style="z-index: 150; animation-duration: 1200ms;"><div class="cm-cursor cm-cursor-primary" style="left: 6px; top: 12px; height: 18.6641px;"></div></div><div class="cm-layer cm-selectionLayer" aria-hidden="true" style="z-index: -2;"></div></div></div></div></div></div><div></div><div class="lm-Widget jp-CellResizeHandle"></div><div class="lm-Widget lm-Panel jp-Cell-outputWrapper"><div class="lm-Widget jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"><div class="jp-Collapser-child"></div></div><div class="lm-Widget jp-OutputArea jp-Cell-outputArea" aria-live="polite"><div class="jp-OutputArea-promptOverlay"></div></div></div><div class="lm-Widget jp-CellFooter jp-Cell-footer"></div></div></div></div><button class="lm-Widget jp-Notebook-footer" tabindex="-1">Click to add a cell.</button></div></div></div></div><div class="lm-Widget" id="spacer-widget-bottom" style="position: absolute; contain: strict; top: 621px; left: 0px; width: 696px; height: 0px;"></div></div><div class="lm-SplitPanel-handle lm-mod-hidden" style="position: absolute; contain: style; top: 0px; left: 696px; width: 1px; height: 621px;"></div><div class="lm-Widget lm-Panel lm-mod-hidden lm-SplitPanel-child" id="jp-right-stack" role="complementary" style="position: absolute; contain: strict;"><button class="jp-Button jp-SidePanel-collapse lm-Widget" title="Collapse right side panel"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" data-icon="ui-components:close" data-icon-id="22880390-0b5b-4107-b303-5e38e5a5c45a"><g class="jp-icon-none jp-icon-selectable-inverse jp-icon3-hover" fill="none"><circle cx="12" cy="12" r="11"></circle></g><g class="jp-icon3 jp-icon-selectable jp-icon-accent2-hover" fill="#616161"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></g><g class="jp-icon-none jp-icon-busy" fill="none"><circle cx="12" cy="12" r="7"></circle></g></svg></button><div class="lm-Widget lm-Panel lm-StackedPanel" style="min-width: 0px; min-height: 0px;"><div class="lm-Widget jp-NotebookTools lm-mod-hidden lm-StackedPanel-child" id="notebook-tools" style="position: absolute; contain: strict;"><div class="lm-Widget jp-Collapse"><div class="lm-Widget jp-Collapse-header jp-Collapse-header-collapsed"><div class="jp-Collapser-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 18 18" data-icon="ui-components:caret-down" data-icon-id="105948d6-4605-4d62-b294-9c742aabe334"><g class="jp-icon3" fill="#616161" shape-rendering="geometricPrecision"><path d="M5.2,7.5L9,11.2l3.8-3.8H5.2z"></path></g></svg></div><span class="jp-Collapser-title">Common Tools</span></div><div class="lm-Widget lm-Panel jp-Collapse-contents lm-mod-hidden"><div class="lm-Widget jp-RankedPanel"><div class="lm-Widget jp-NotebookTools-tool"><div class="lm-Widget jp-MetadataForm-placeholder"><div class="jp-MetadataForm-placeholderContent">No metadata.</div></div></div></div></div></div><div class="lm-Widget jp-Collapse"><div class="lm-Widget jp-Collapse-header jp-Collapse-header-collapsed"><div class="jp-Collapser-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" viewBox="0 0 18 18" data-icon="ui-components:caret-down" data-icon-id="105948d6-4605-4d62-b294-9c742aabe334"><g class="jp-icon3" fill="#616161" shape-rendering="geometricPrecision"><path d="M5.2,7.5L9,11.2l3.8-3.8H5.2z"></path></g></svg></div><span class="jp-Collapser-title">Advanced Tools</span></div><div class="lm-Widget lm-Panel jp-Collapse-contents lm-mod-hidden"><div class="lm-Widget jp-RankedPanel"><div class="lm-Widget jp-NotebookTools-tool"><div class="lm-Widget jp-MetadataForm-placeholder"><div class="jp-MetadataForm-placeholderContent">No metadata.</div></div></div></div></div></div></div></div></div><div class="lm-SplitPanel-handle lm-mod-hidden" style="position: absolute; contain: style;"></div></div></div>